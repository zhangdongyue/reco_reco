// 15.0.4823.1000 
Type.registerNamespace("WordViewer");WordViewer.$29=function(){WordViewer.$29.initializeBase(this)};WordViewer.$29.$8d=function(b,c){var a=new WordViewer.$29;a.FileId=b;a.SharedLock=false;a.DocNormal=c;return a};WordViewer.$29.prototype={FileId:null,SharedLock:false,DocNormal:false,$Xq:function(){return 15}};WordViewer.$2j=function(){WordViewer.$2j.initializeBase(this)};WordViewer.$2j.$8d=function(b,c,d,e,f,g,h){var a=new WordViewer.$2j;a.FileId=b;a.StartParaId=d;a.EndParaId=e;a.Time=f;a.Text=c;a.SharedLock=g;a.CommId=h;return a};WordViewer.$2j.prototype={FileId:null,SharedLock:false,CommId:null,Time:0,Text:null,StartParaId:null,EndParaId:null,$Xq:function(){return 17}};WordViewer.$2N=function(){WordViewer.$2N.initializeBase(this)};WordViewer.$2N.$8d=function(b,c,d,e,f,g){var a=new WordViewer.$2N;a.FileId=b;a.GuardParaId=d;a.Time=e;a.Text=c;a.SharedLock=f;a.CommId=g;return a};WordViewer.$2N.prototype={FileId:null,SharedLock:false,CommId:null,Time:0,Text:null,GuardParaId:null,$Xq:function(){return 18}};WordViewer.$2o=function(){WordViewer.$2o.initializeBase(this)};WordViewer.$2o.$8d=function(b,c,d){var a=new WordViewer.$2o;a.FileId=b;a.GuardParaId=c;a.SharedLock=d;return a};WordViewer.$2o.prototype={FileId:null,SharedLock:false,GuardParaId:null,$Xq:function(){return 16}};WordViewer.$2m=function(){WordViewer.$2m.initializeBase(this)};WordViewer.$2m.$8d=function(b,c,d,e){var a=new WordViewer.$2m;a.FileId=b;a.GuardParaId=c;a.Done=d;a.SharedLock=e;return a};WordViewer.$2m.prototype={FileId:null,SharedLock:false,GuardParaId:null,Done:false,$Xq:function(){return 19}};WordViewer.$2q=function(){WordViewer.$2q.initializeBase(this)};WordViewer.$2q.$8d=function(b,c){var a=new WordViewer.$2q;a.FileId=b;a.SharedLock=c;return a};WordViewer.$2q.prototype={FileId:null,SharedLock:false,$Xq:function(){return 20}};WordViewer.$68=function(){WordViewer.$68.initializeBase(this)};WordViewer.$68.prototype={FileId:null,SharedLock:false,Refresh:0};WordViewer.$67=function(){WordViewer.$67.initializeBase(this)};WordViewer.$67.prototype={ParaId:null,CommId:null};WordViewer.$66=function(){WordViewer.$66.initializeBase(this)};WordViewer.$66.prototype={ParaId:null,CommId:null};WordViewer.$3Z=function(){};WordViewer.$3Z.$vr=function(){Common.$q.$b8(WordViewer.$3Z.$X1);var a=WordViewer.Selection.$W.get_$0();WordViewer.App.get_$1().$B.$tv(a,a.$$d_$AJ,a.$$d_$AS);if(!WordViewer.App.$0.$2r){var b=WordViewer.Search.$X.get_$0();WordViewer.App.get_$1().$B.$tu(b,b.$$d_$ZA)}WordViewer.App.get_$1().$B.$tV(WordViewer.Comments.$I.get_$0());WordViewer.App.get_$1().$1L&&WordViewer.App.get_$1().$1L.$3r()};WordViewer.$3Z.$X1=function(a,b,c,d,e){return a===3510751882?WordViewer.Comments.$I.get_$0().$LB(a,b,c,d,e):a===428795035?WordViewer.Search.$X.get_$0().$LH(a,b,c,d,e):a===976411380?WordViewer.Search.$X.get_$0().$cv(a,b,c,d,e):a===2281051331?WordViewer.Comments.$I.get_$0().$cu(a,b,c,d,e):2};Type.registerNamespace("WordViewer.Comments");WordViewer.Comments.$18=function(a,b,c,d,e,f,g,h){this.$EY=0;this.$9o=2;this.$B3=0;this.dispose=this.$F;this.$8=a;this.$74=b;this.$Lo=c;this.$BA=d;this.$39=e;this.$BF=f;this.$5M=g;this.$1F=h};WordViewer.Comments.$18.$Wg=function(c,d,e){var b="new"+Common.$9.$qJ(WordViewer.Comments.$18.$Qs.toString(),8,"0");WordViewer.Comments.$18.$Qs++;var a=new WordViewer.Comments.$18(b,WordViewer.Comments.$18.$YV,c,new Date,d,false,new Array(0),e);a.$B3=1;a.$9o=0;return a};WordViewer.Comments.$18.prototype={$8:null,$Lo:null,$BA:null,$BF:false,$74:null,$So:null,$Sn:null,$5M:null,$1F:0,$39:null,$3C:null,get_$PS:function(){return this.$BF},set_$PS:function(a){if(this.$BF!==a){this.$BF=a;this.$3C.$At()}return a},get_$DD:function(){return this.$EY},set_$DD:function(a){if(this.$EY!==a){this.$EY=a;this.$3C&&this.$3C.$At()}return a},get_$G2:function(){return this.$9o},set_$G2:function(a){if(this.$9o!==a){if(!this.$9o&&a===2)return a;if(this.$9o===3)return a;this.$9o=a;this.$3C&&this.$3C.$At()}return a},get_$8c:function(){return this.$B3},set_$8c:function(a){if(this.$B3!==a){this.$B3=a;this.$3C.$jd()}return a},get_$J2:function(){return this.$3C.$O},$F:function(){if(this.$3C){this.$3C.$F();this.$3C=null}},$RK:function(){this.$3C=new WordViewer.Comments.$2n(this);return this.$3C.$O},$KT:function(){this.$3C&&this.$3C.$At()},$Ce:function(){if(this.$B3===1)this.$3C.$jk();else this.$3C.$Ce()},toString:function(){var a="[null]";if(this.$5M&&this.$5M.length>0)a=this.$5M[0].length>30?this.$5M[0].substr(0,30)+"...":this.$5M[0];return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this.$8||"[null]",this.$Lo||"[null]",!this.$BA?"[null]":this.$BA.toString(),this.$39||"[null]",this.$BF,a)},$aC:function(){if(WordViewer.Comments.$I.get_$0().get_$s()===2)return;Common.$E.$0().$2Q("CommentPane");this.$EY!==1&&WordViewer.Comments.$I.get_$0().$5k(this.$8)},$oP:function(){Common.$E.$0().$2Q("CommentPane");WordViewer.Comments.$I.get_$0().$JD(this)},$q1:function(){WordViewer.Comments.$I.get_$0().$WK(this,!this.$BF)},$pj:function(){if(WordViewer.Comments.$I.get_$0().get_$s()===2)return;Common.$E.$0().$2Q("CommentPane");var a=this.$39||this.$8;WordViewer.Comments.$I.get_$0().$es(a)},$pr:function(a){Common.$E.$0().$2Q("CommentPane");this.$5M=new Array(1);this.$5M[0]=a;WordViewer.Comments.$I.get_$0().$WV(this)},$Qx:function(){Common.$E.$0().$2Q("CommentPane");WordViewer.Comments.$I.get_$0().$1l.$1Q.focus();WordViewer.Comments.$I.get_$0().$JD(this);WordViewer.Comments.$I.get_$0().set_$s(1);this.$39&&WordViewer.Comments.$I.get_$0().$5k(this.$39)}};WordViewer.Comments.$i=function(a,b){this.$6r=WordViewer.Comments.$i.$3o;this.$56=WordViewer.Comments.$i.$3o;this.$3Z=[];this.$2l=[];this.$55=a;this.$1F=b};WordViewer.Comments.$i.$d2=function(c,f){f.val=null;var d=parseFloat(WordViewer.$6.$1Y(c,"l")),e=parseFloat(WordViewer.$6.$1Y(c,"t")),a=parseFloat(WordViewer.$6.$1Y(c,"w")),b=parseFloat(WordViewer.$6.$1Y(c,"h"));if(isNaN(d)||isNaN(e)||isNaN(a)||isNaN(b))return false;if(a<8)a=8;if(b<10)b=10;f.val=new WordViewer.$1v(d,e,a,b);return true};WordViewer.Comments.$i.$WZ=function(g,h){var a=g,b=h;if(!a.$6F||!b.$6F)return 0;var c=a.$2l[0],d=b.$2l[0];if(c!==d)return c-d;var e=a.$3Z[0],f=b.$3Z[0];return e.$1V===f.$1V?0:e.$1V<f.$1V?-1:1};WordViewer.Comments.$i.prototype={$55:null,$1F:0,$6F:false,$BZ:false,$9E:0,get_$nU:function(){return this.$6r!==WordViewer.Comments.$i.$3o||this.$56!==WordViewer.Comments.$i.$3o},$vI:function(d,e){var a,b,c;if(!(c=WordViewer.Comments.$i.$d2(d,b={val:a}),a=b.val,c))return false;Array.add(this.$3Z,a);Array.add(this.$2l,e);return true},$lr:function(f,d){if(d.length<1)return;var e=d[0],b=[],c=[],a=0;while(a<this.$2l.length){if(e<this.$2l[a])break;Array.add(b,this.$3Z[a]);Array.add(c,this.$2l[a]);a++}Array.addRange(b,f);Array.addRange(c,d);for(;a<this.$2l.length;a++){Array.add(b,this.$3Z[a]);Array.add(c,this.$2l[a])}this.$3Z=b;this.$2l=c},$gq:function(b){var a=new WordViewer.Comments.$i(b,this.$1F);a.$3Z=Array.clone(this.$3Z);a.$2l=Array.clone(this.$2l);a.$6F=this.$6F;a.$BZ=this.$BZ;return a}};WordViewer.Comments.$2R=function(d,e,f,g){this.$$d_$pJ=Function.createDelegate(this,this.$pJ);this.$$d_$pL=Function.createDelegate(this,this.$pL);this.$$d_$or=Function.createDelegate(this,this.$or);this.$4N=[];this.dispose=this.$F;this.$1F=e;this.$1V=f;Array.add(this.$4N,g);this.$3d=document.createElement("span");this.$3d.className="CommentHint";this.$3d.setAttribute("count",1);var a=Common.$N.$3D(16,16,"CommentHint_16x16x32","",true,WordViewerIntl.WordViewerStrings.l_CommentHintTooltip);this.$3d.appendChild(a);d.appendChild(this.$3d);this.$1R=a.firstChild;this.$am();var c=WordViewer.App.get_$1().$1H;c.$4("click",this.$3d,this.$$d_$or,null);var b=WordViewer.App.get_$1().$3Y;b.$4("mouseover",this.$1R,this.$$d_$pL,null);b.$4("mouseout",this.$1R,this.$$d_$pJ,null)};WordViewer.Comments.$2R.prototype={$3d:null,$1R:null,$1F:0,$1V:0,$s6:function(a,b,c){this.$1F=a;this.$1V=b;Array.clear(this.$4N);Array.add(this.$4N,c);this.$3d.setAttribute("count",1);this.$am()},$F:function(){var b=WordViewer.App.get_$1().$1H;b.$A("click",this.$3d,this.$$d_$or);this.$3d=null;var a=WordViewer.App.get_$1().$3Y;a.$A("mouseover",this.$1R,this.$$d_$pL);a.$A("mouseout",this.$1R,this.$$d_$pJ);this.$1R=null},$bC:function(a){Array.add(this.$4N,a);this.$3d.setAttribute("count",this.$4N.length);this.$4N.sort()},$vM:function(a){Array.remove(this.$4N,a);this.$3d.setAttribute("count",this.$4N.length);if(!this.$4N.length){this.$bI();return false}return true},$bI:function(){this.$3d.parentNode.removeChild(this.$3d)},$am:function(){var a=WordViewer.App.get_$1().$B.$1W(),c=WordViewer.DocumentData.$8.$2y(this.$1F,a)+Math.round(this.$1V*a),b=0;if(Common.$0.get_$d())b=6+WordViewer.DocumentData.$8.$6U(this.$1F,a,false);else b=WordViewer.DocumentData.$8.$4n(this.$1F,a)-22+WordViewer.DocumentData.$8.$6U(this.$1F,a,false);WordViewer.$P.$fB(this.$3d,c,b)},$or:function(b){var a=new Common.$2M(null,b.$1E);Common.$0.$5.$t(3510751882,2,a);WordViewer.Comments.$I.get_$0().$5k(this.$4N[0]);Common.$0.$5.$N(1951217806,2);return true},$pL:function(){this.$1R.className=Common.$N.$2F("CommentHintHover_16x16x32");return true},$pJ:function(){this.$1R.className=Common.$N.$2F("CommentHint_16x16x32");return true}};WordViewer.Comments.$x=function(a){this.$$d_$mm=Function.createDelegate(this,this.$mm);this.$$d_$R7=Function.createDelegate(this,this.$R7);this.$$d_$q8=Function.createDelegate(this,this.$q8);this.$$d_$pi=Function.createDelegate(this,this.$pi);this.$$d_$qB=Function.createDelegate(this,this.$qB);this.$$d_$iA=Function.createDelegate(this,this.$iA);this.$4O={};this.$99={};this.$6K=[];this.$2Y=[];this.$7n=[];this.$Nb={};this.dispose=this.$F;this.$EX=a;if(WordViewer.App.$0.$2r)return;this.$HE=new Common.$p(3,1,WordViewer.App.$0.$I.$Jv,this.$$d_$iA);Common.$0.$5.$C(4224281129,1,this.$$d_$qB);Common.$0.$5.$C(2918606216,1,this.$$d_$pi);Common.$0.$5.$C(3917526816,1,this.$$d_$q8);WordViewer.App.get_$1().$z.$4(0,this.$$d_$R7,null);this.$BW=new Common.$p(3,1,1e3,this.$$d_$mm);Common.$0.$E.$i(this.$BW)};WordViewer.Comments.$x.$n3=function(a){return"hi_"+a};WordViewer.Comments.$x.$l2=function(a){return String.format("/Pages/Page[@id='{0}']/descendant::P/CB",a)};WordViewer.Comments.$x.$l4=function(a){return String.format("/Pages/Page[@id='{0}']/descendant::P/CE",a)};WordViewer.Comments.$x.$l3=function(a){return String.format("/Pages/Page[@id='{0}']/CC",a)};WordViewer.Comments.$x.$Jr=function(a,b){return String.format("/Pages/Page[@id='{0}']//T[@id='{1}']",a,b)};WordViewer.Comments.$x.$l5=function(a){return String.format("/Pages/Page[@id='{0}']/descendant::T[1]",a)};WordViewer.Comments.$x.$l7=function(a){return String.format("/Pages/Page[@id='{0}']/descendant::T[last()]",a)};WordViewer.Comments.$x.$Z1=function(b){var a=parseInt(WordViewer.$6.$1Y(b,"storyId"));return a!==1?false:true};WordViewer.Comments.$x.$Yw=function(a){return!WordViewer.Comments.$x.$Z1(a)?false:a.firstChild&&a.firstChild.nodeName==="CN"?false:true};WordViewer.Comments.$x.prototype={$EX:null,$91:null,$54:null,$El:false,$HE:null,$BW:null,$F:function(){this.$Kk();for(var a=0;a<this.$2Y.length;a++)this.$2Y[a].$F();this.$2Y=[];this.$99={};this.$4O={};this.$6K=[];this.$7n=[];this.$54=null;WordViewer.App.get_$1().$z.$A(0,this.$$d_$R7)},$Cq:function(a,c){if(this.$54!==a){this.$54=a;this.$El=false;if(this.$91){Common.$0.$E.$2x(this.$HE);this.$91=null}}var b=this.$4O[a.$8];if(!b||!b.$6F){if(c){WordViewer.App.get_$1().$B.$Kv(a.$1F);this.$El=true;this.$Kk()}return}this.$El=false;this.$Yj(b,c)},$gf:function(){this.$Kk();this.$54=null;this.$91=null;this.$El=false},$Kk:function(){for(var a=0;a<this.$7n.length;a++){var b=this.$7n[a];WordViewer.Highlight.$h.get_$0().$Km(b)}this.$7n=[]},$hG:function(h,n,o,c){n.val=o.val=null;c.val=null;var a=WordViewer.Selection.$W.get_$0().get_$bx(),b=WordViewer.Selection.$W.get_$0().get_$bw();if(!a||!b){a=WordViewer.Selection.$W.get_$0().get_$qs();b=WordViewer.Selection.$W.get_$0().get_$qr()}if(!a||!b){var d=WordViewer.Search.$X.get_$0().$2o;if(d&&d.$2o){var l=d.$2o.$V,t=d.$2o.$VF,m=WordViewer.App.get_$1().$1B.$7V(l);if(!m)return 1;var g=m.selectSingleNode(WordViewer.Comments.$x.$Jr(l,t));if(!g)return 1;a=new WordViewer.Selection.$2G(null,g);b=new WordViewer.Selection.$2G(null,g)}}if(!a||!b)return 1;var p=WordViewer.App.get_$1().$1B.$7V(a.$V),e=p.selectSingleNode(WordViewer.Comments.$x.$Jr(a.$V,a.$8)),q=e.selectSingleNode("preceding-sibling::T[last()]")||e,i=e.selectSingleNode("ancestor::P"),r=WordViewer.App.get_$1().$1B.$7V(b.$V),f=r.selectSingleNode(WordViewer.Comments.$x.$Jr(b.$V,b.$8)),s=f.selectSingleNode("following-sibling::T[last()]")||f,j=f.selectSingleNode("ancestor::P");if(!WordViewer.Comments.$x.$Yw(i)||!WordViewer.Comments.$x.$Yw(j))return 2;c.val=new WordViewer.Comments.$i(h,a.$V);c.val.$6r=parseInt(WordViewer.$6.$1Y(q,"id"));c.val.$56=parseInt(WordViewer.$6.$1Y(s,"id"));c.val.$9E=a.$V;c.val.$6F=true;n.val=WordViewer.$6.$1Y(i,"id");o.val=WordViewer.$6.$1Y(j,"id");var k=[];Array.add(k,c.val);this.$aQ(k);this.$4O[h]=c.val;Array.add(this.$6K,h);this.$PL();return 0},$hF:function(a){var b=this.$4O[a.$39];if(b){var c=b.$gq(a.$8);this.$4O[a.$8]=c}},$gx:function(d){for(var c=0;c<d.length;c++){var a=d[c];this.$4O[a.$8]=null;var b=this.$99[a.$8];if(b){if(!b.$vM(a.$8)){Array.remove(this.$2Y,b);b.$F();this.$99[a.$8]=null}}else Array.contains(this.$6K,a.$8)&&Array.remove(this.$6K,a.$8)}},$k6:function(a){return this.$4O[a]},$aU:function(d){for(var b=[],a=d.$AJ;a<=d.$AS;a++){if(this.$Nb[a.toString()])continue;var c=WordViewer.App.get_$1().$1B.$7V(a);if(!c)continue;if(a===d.$AJ){var k=c.selectNodes(WordViewer.Comments.$x.$l3(a));this.$qQ(a,c,k,b)}var i=c.selectNodes(WordViewer.Comments.$x.$l2(a));this.$aR(a,i,true,b);var j=c.selectNodes(WordViewer.Comments.$x.$l4(a));this.$aR(a,j,false,b);this.$Nb[a.toString()]=true;if(a===d.$AS)for(var e=WordViewer.Comments.$i.$3o,f=0;f<b.length;f++){var g=b[f];if(!g.$BZ&&g.$56===WordViewer.Comments.$i.$3o){if(e===WordViewer.Comments.$i.$3o){var l=c.selectSingleNode(WordViewer.Comments.$x.$l7(a));e=parseInt(WordViewer.$6.$1Y(l,"id"))}g.$56=e}}}this.$aQ(b);if(this.$54)for(var h=0;h<b.length;h++)if(this.$54.$8===b[h].$55){this.$Cq(this.$54,this.$El);break}},$aR:function(f,b,g,h){for(var c=b.length,a=0;a<c;a++){var d=b[a],e=this.$hH(d,f,g);Array.add(h,e)}},$qQ:function(c,j,d,k){if(!d.length)return;for(var e=j.selectSingleNode(WordViewer.Comments.$x.$l5(c)),f=parseInt(WordViewer.$6.$1Y(e,"id")),g=d.length,a=0;a<g;a++){var h=d[a],i=WordViewer.$6.$1Y(h,"id"),b=this.$XC(c,i);b.$6r=f;b.$9E=c;Array.add(k,b)}},$hH:function(g,e,c){var f=WordViewer.$6.$1Y(g,"id"),b=this.$XC(e,f);if(b.$BZ)return b;var d=false,a=g;while(true){a=c?a.nextSibling:a.previousSibling;if(!a)break;if(a.nodeName==="T"){d=true;var h=parseInt(WordViewer.$6.$1Y(a,"id"));if(c){if(b.$6r!==WordViewer.Comments.$i.$3o)return b;b.$6r=h;b.$9E=e;b.$6F=true}else{if(b.$56!==WordViewer.Comments.$i.$3o)return b;b.$56=h}break}else if(c&&a.nodeName==="CE"){if(f!==WordViewer.$6.$1Y(a,"id"))continue;if(b.$vI(a,e)){d=true;b.$BZ=true;b.$6F=true;b.$9E=e}break}else if(!c&&a.nodeName==="CB"){if(f!==WordViewer.$6.$1Y(a,"id"))continue}else continue}if(!d)if(!c){a=g;while(true){a=a.nextSibling;if(!a)break;if(a.nodeName==="T"){d=true;var i=parseInt(WordViewer.$6.$1Y(a,"id"));b.$56=i-1;break}}}return b},$XC:function(c,b){var a=this.$4O[b];if(!a){a=new WordViewer.Comments.$i(b,c);this.$4O[b]=a;Array.add(this.$6K,b)}return a},$aQ:function(l){for(var d=0;d<l.length;d++){var a=l[d];if(!a.get_$nU())continue;if(a.$BZ)continue;if(a.$6r===WordViewer.Comments.$i.$3o)continue;if(a.$56===WordViewer.Comments.$i.$3o)continue;if(a.$9E<=0)continue;for(var c=a.$9E,e=WordViewer.App.get_$1().$1B.$7V(c),f=[],k=[],g=a.$6r;g<=a.$56;g++){var b=null;do{b=e.selectSingleNode(WordViewer.Comments.$x.$Jr(c,g));if(b)break;c++;e=WordViewer.App.get_$1().$1B.$7V(c);if(!e)break}while(!b);if(!b)break;if(b.parentNode.nodeName!=="P")continue;if(!WordViewer.Comments.$x.$Z1(b.parentNode))continue;var h,i,j;if(j=WordViewer.Comments.$i.$d2(b,i={val:h}),h=i.val,j){Array.add(f,h);Array.add(k,c)}}f.length&&a.$lr(f,k);a.$9E=0;a.$56=WordViewer.Comments.$i.$3o;a.$6r=WordViewer.Comments.$i.$3o}},$PL:function(){var j=WordViewer.App.get_$1().$B.$1W(),c=0;while(c<this.$6K.length){var i=this.$6K[c],b=this.$4O[i];if(!b.$6F){c++;continue}if(!b.$3Z.length){Array.removeAt(this.$6K,c);continue}for(var f=b.$3Z[0].$1V,d=b.$2l[0],a=null,e=0;e<this.$2Y.length;e++){var g=this.$2Y[e];if(d>g.$1F)continue;if(d<g.$1F){a=new WordViewer.Comments.$2R(this.$EX,d,f,b.$55);Array.insert(this.$2Y,e,a);break}var h=(f-g.$1V)*j;if(h>=16)continue;if(Math.abs(h)<16){a=g;a.$bC(i);break}if(h<0){a=new WordViewer.Comments.$2R(this.$EX,d,f,b.$55);Array.insert(this.$2Y,e,a);break}}if(!a){a=new WordViewer.Comments.$2R(this.$EX,d,f,b.$55);Array.add(this.$2Y,a)}this.$99[b.$55]=a;Array.removeAt(this.$6K,c)}},$XD:function(g,h){var a=WordViewer.App.get_$1().$B,b=a.$1W(),i=a.$5a(),l=a.$Jg(),m=i+l,j=a.$Cm(),n=a.$5b(),o=j+n,p=WordViewer.DocumentData.$8.$2y(h,b),q=WordViewer.DocumentData.$8.$6U(h,b,false),c=Math.round(p+g.$1V*b),r=c+Math.round(g.$5C*b),d=Math.round(q+g.$2s*b),e=Number.NaN,f=Number.NaN;if(i>c||m<r)e=c-40;if(j>d||o<d)f=d-40;if(isNaN(e)&&isNaN(f))return;var k=new WordViewer.Controls.$1c(e,f);Common.$0.$5.$t(702693766,2,k);WordViewer.App.$0.$2Z&&WordViewer.$J.$Kz(h,k,2)},$bQ:function(){for(var d=[],h=0;h<this.$2Y.length;h++){var o=this.$2Y[h];Array.addRange(d,o.$4N)}for(var k=[],e=new Array(d.length),f=0;f<d.length;f++)e[f]=this.$4O[d[f]];e.sort(WordViewer.Comments.$i.$WZ);for(var l=WordViewer.App.get_$1().$B.$1W(),m=0,c=null,i=0;i<e.length;i++){var a=e[i],g=a.$3Z[0];if(!c||c.$1F!==a.$1F||m<g.$1V*l){var b;if(this.$2Y.length>0){b=this.$2Y[0];Array.removeAt(this.$2Y,0);b.$s6(a.$2l[0],g.$1V,a.$55)}else b=new WordViewer.Comments.$2R(this.$EX,a.$2l[0],g.$1V,a.$55);Array.add(k,b);c=b;m=g.$1V*l+16;this.$99[a.$55]=b}else{c.$bC(a.$55);this.$99[a.$55]=c}}for(var j=0;j<this.$2Y.length;j++){var n=this.$2Y[j];n.$bI();n.$F()}this.$2Y=k},$Yj:function(b,e){this.$Kk();for(var g=WordViewer.App.get_$1().$B.$1W(),a=0;a<b.$3Z.length;a++){var f=b.$3Z[a],d=b.$2l[a];if(!WordViewer.Highlight.$h.get_$0().$Z4(d))if(!a&&e){this.$91=b;this.$HE.$J9=e;Common.$0.$E.$i(this.$HE);this.$XD(f,d);return}else continue;var c=WordViewer.Highlight.$h.get_$0().$PU(f,3,WordViewer.Comments.$x.$n3(a),d);c.$L8(c.get_$Ey(),c.get_$qK(),g);Array.add(this.$7n,c)}this.$91=null;e&&this.$7n.length>0&&this.$XD(this.$7n[0].get_$Ey(),b.$2l[0])},$iA:function(a){this.$91&&this.$Yj(this.$91,a.$J9)},$R7:function(){this.$bQ();this.$54&&WordViewer.Highlight.$h.get_$0().get_$nT()&&this.$Cq(this.$54,false)},$pi:function(b,c,a){if(a===1)return 32;this.$bQ();return 32},$q8:function(b,c,a){if(a===1)return 32;this.$54&&this.$Cq(this.$54,false);return 32},$qB:function(d,e,b,f,c){if(b===1)return 32;if(this.$BW){Common.$0.$E.$2x(this.$BW);this.$BW=null}var a=c;this.$aU(a);this.$PL();return 32},$mm:function(){this.$BW=null;var a=WordViewer.App.get_$1().$B.$4A();if(!WordViewer.App.get_$1().$1B.$mH(a))return;var b=WordViewer.$6.$YG(a),c=new WordViewer.Selection.$2Y(WordViewer.$6.$Pw(b),WordViewer.$6.$Xx(b));this.$aU(c);this.$PL()}};WordViewer.Comments.$I=function(b,c){this.$$d_$rO=Function.createDelegate(this,this.$rO);this.$$d_$oF=Function.createDelegate(this,this.$oF);this.$$d_$oG=Function.createDelegate(this,this.$oG);this.$$d_$rP=Function.createDelegate(this,this.$rP);this.$$d_$rb=Function.createDelegate(this,this.$rb);this.$$d_$fd=Function.createDelegate(this,this.$fd);this.$$d_$iD=Function.createDelegate(this,this.$iD);this.$7z=0;this.dispose=this.$F;if(WordViewer.App.$0.get_$FN()){this.$1l=new WordViewer.Comments.$2C(b);this.$24=new WordViewer.Comments.$z;this.$4V=new WordViewer.Comments.$x(c);var a=Common.$0.$5;a.$C(3259256685,1,Common.$U.$2g);a.$C(1637502579,1,Common.$U.$2g);a.$C(863375655,1,Common.$U.$2g);a.$C(1510212254,1,Common.$U.$2g);a.$C(467845448,1,Common.$U.$2g);a.$C(375707647,1,Common.$U.$2g);a.$C(2718896640,1,Common.$U.$2g);a.$C(3609945866,1,Common.$U.$2g);a.$C(159412208,1,Common.$U.$2g);a.$C(1951217806,1,Common.$U.$2g);a.$C(1046295975,1,Common.$U.$2g);a.$C(2462410242,1,Common.$U.$2g);a.$C(4041287661,1,Common.$U.$2g);a.$C(516537638,1,Common.$U.$2g);a.$C(1991982245,1,Common.$U.$2g);a.$C(4156131848,1,Common.$U.$2g);a.$C(3103450156,1,Common.$U.$2g);this.$jW()}};WordViewer.Comments.$I.get_$0=function(){if(!WordViewer.Comments.$I.$D&&!WordViewer.Comments.$I.$2q){WordViewer.Comments.$I.$2q=true;WordViewer.Comments.$I.$D=new WordViewer.Comments.$I(WordViewer.App.get_$1().$B.$1w,WordViewer.App.get_$1().$B.$1h.$3A);if(WordViewer.App.$0.get_$LZ()&&WordViewer.App.$0.get_$FN())WordViewer.Comments.$I.$D.set_$s(1);else if(!WordViewer.App.$0.get_$FN())WordViewer.Comments.$I.$D.set_$s(-1);else WordViewer.Comments.$I.$D.set_$s(0);WordViewer.Comments.$I.$2q=false}return WordViewer.Comments.$I.$D};WordViewer.Comments.$I.$kT=function(c,b,a){b.val=null;switch(c){case 1:a.val=5373974;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;case 7:a.val=5373975;return null;case 14:a.val=5373976;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;case 36:a.val=5373977;return WordViewerIntl.WordViewerStrings.l_OldProductDigitalSignatureOpen;case 9:a.val=5373978;return WordViewerIntl.WordViewerStrings.l_DocumentProtectionSettingsCommentOpen;case 30:a.val=5373979;return WordViewerIntl.WordViewerStrings.l_DocumentPasswordEncryptedOpen;case 31:a.val=5373980;return WordViewerIntl.WordViewerStrings.l_CheckedOutOpen;case 17:a.val=5373981;return WordViewerIntl.WordViewerStrings.l_RequiresCheckoutOpen;case 16:a.val=5373982;return WordViewerIntl.WordViewerStrings.l_LockedForOfflineCheckoutOpen;case 11:a.val=5373983;b.val=WordViewerIntl.WordViewerStrings.l_CoauthHelpContextId;return WordViewerIntl.WordViewerStrings.l_LockedByOtherInterfaceOpen;case 12:a.val=5373984;return WordViewerIntl.WordViewerStrings.l_CorruptFileOpen;case 57:a.val=5373985;return WordViewerIntl.WordViewerStrings.l_NumberOfCoauthorsReachedMaxOpen;case 61:a.val=5373986;return WordViewerIntl.WordViewerStrings.l_DocumentMarkedFinalOpen;case 38:a.val=5373987;return WordViewerIntl.WordViewerStrings.l_PreReleaseFile;case 69:a.val=5373988;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;case 35:a.val=5373989;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;case 47:a.val=5373990;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;case 39:a.val=5373991;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;case 33:a.val=5373992;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen;default:a.val=5373976;return WordViewerIntl.WordViewerStrings.l_GenericErrorOpen}};WordViewer.Comments.$I.prototype={$1l:null,$24:null,$4V:null,$Gg:null,$Ma:false,$HJ:false,$5n:null,$Bx:null,$8Q:null,$6B:null,$7H:false,$Gh:false,$EZ:false,$Ur:0,get_$i3:function(){return Common.$0.$S2},get_$ct:function(){return Common.$0.$L9},get_$s:function(){return this.$7z},set_$s:function(a){if(a!==this.$7z){this.$7z=a;if(this.$7z===-1)return a;this.$1l.$KT();this.$24.$KT();!this.$7z&&this.$XA()}return a},$F:function(){if(this.$6B){this.$6B.$F();this.$6B=null}if(this.$1l){this.$1l.$F();this.$1l=null}if(this.$24){this.$24.$F();this.$24=null}if(this.$4V){this.$4V.$F();this.$4V=null}this.$XA()},$5k:function(b){var a=this.$24.$FR(b);if(!a)return;if(this.get_$s()===2&&a.get_$8c()!==1)return;this.$24.$5k(a);this.$4V.$Cq(a,true);this.$1l.$5k(a)},$Rn:function(){var a=this.$24.$Rn();if(!a)return;this.$4V.$Cq(a,true);this.$1l.$5k(a)},$Ro:function(){var a=this.$24.$Ro();if(!a)return;this.$4V.$Cq(a,true);this.$1l.$5k(a)},$4k:function(){this.$24.$4k();this.$4V.$gf()},$qO:function(){if(this.$7z===2){this.$4k();var a=this.$24.$BX;this.$JD(a);this.set_$s(1)}else this.$4k()},$ef:function(){if(this.get_$s()!==1)return;var a=WordViewer.Comments.$z.$hi(),d,e,b,f,g,h,i,j=(i=this.$4V.$hG(a.$8,f={val:d},g={val:e},h={val:b}),d=f.val,e=g.val,b=h.val,i);if(!b||j){var c;switch(j){case 1:Common.$0.$3W(5374015);c=WordViewerIntl.WordViewerStrings.l_NewCommentError;break;case 2:Common.$0.$3W(5374016);c=WordViewerIntl.WordViewerStrings.l_NewCommentInvalidContent;break;case 0:default:c=WordViewerIntl.WordViewerStrings.l_NewCommentError}var k=new CommonUI.$t;k.set_$W(0);k.$LE(CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,c,null);return}a.$So=d;a.$Sn=e;WordViewer.Selection.$W.get_$0().$4k();this.$24.$eg(a,b);this.$1l.$bL(a);this.$5k(a.$8);Common.$0.$5.$N(1046295975,2)},$es:function(b){if(this.get_$s()!==1)return;var a=this.$24.$hI(b);this.$4V.$hF(a);this.$1l.$bL(a);this.$5k(a.$8);Common.$0.$5.$N(4041287661,2)},$JD:function(a){if(this.get_$s()!==1)if(this.get_$s()===2){if(a.get_$8c()!==1)return}else return;if(a.get_$8c()!==1){this.$Gg=a;var b=new CommonUI.$t;b.set_$W(4);b.$uT(CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,WordViewerIntl.WordViewerStrings.l_DeleteCommentConfirm,this.$$d_$iD);return}Common.$0.$5.$N(1510212254,2);this.$Wv(a)},$iD:function(a){if(a===1)this.$Wv(this.$Gg);else this.$Gg=null},$Wv:function(c){Common.$0.$5.$N(467845448,2);this.$Gg=null;this.$4k();var a=this.$24.$JD(c);this.$1l.$rk(a);this.$4V.$gx(a);for(var b=0;b<a.length;b++)a[b].$F()},$WK:function(b,a){if(!this.get_$s())return;Common.$0.$5.$N(a?375707647:3103450156,2);this.$24.$WK(b,a)},$WV:function(a){this.$24.$WV(a);this.set_$s(1);Common.$0.$5.$N(2462410242,2)},$lg:function(){if(this.$HJ){this.$1l.get_$Er()&&this.$1l.set_$Er(false);return}if(Common.$0.$GL){var b="wdcomments=1",c=WordViewer.App.get_$1().$AO();if(c)b+="&wdparaid="+c;var d=Common.$13.$4u(true,"UI_RedeemForCommenting",true,{targetWacAction:"View",wdparams:b});d===8&&WordViewer.App.get_$1().$3U(true,Common.$0.$AB);Common.$0.$GL=false}if(!this.$7z){if(!this.$EZ){this.$EZ=true;this.$Af()}return}if(this.$5n)return;this.$Ur=0;var a=new WordViewer.$2Q(1,this.$$d_$fd);this.$5n=new WordViewer.$2d;this.$5n.set_$6e(WordViewer.$29.$8d(WordViewer.App.$0.$3t,WordViewer.DocumentData.$8.get_$QN()));this.$5n.$Y=1;a.$Il(this.$5n);a.$8g()},$XA:function(){if(!this.$HJ)return;var b=new WordViewer.$2Q(1,null),a=new WordViewer.$2d;a.set_$6e(WordViewer.$2q.$8d(WordViewer.App.$0.$3t,this.$Ma));a.$Y=1;b.$Il(a);b.$8g();this.$HJ=false;if(this.$Bx&&!Common.$0.$1X){Common.$0.$E.$2x(this.$Bx);this.$Bx=null}},$fd:function(m){if(Common.$0.$1X)return;if(this.$5n.$7j===5){if(this.$7H){this.set_$s(0);this.$EZ=true;this.$Af();var j=new CommonUI.$t;j.set_$W(0);j.$6g(5374012,CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,WordViewerIntl.WordViewerStrings.l_GenericErrorOpen,null);return}this.$7H=true;m.$8g();return}this.$7H=false;this.$EZ=true;if(this.$5n.$7j!==2||!this.$5n.$5P){this.set_$s(0);this.$Af();var k=new CommonUI.$t;k.set_$W(0);k.$6g(5374019,CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,WordViewerIntl.WordViewerStrings.l_GenericErrorOpen,null);return}var a=this.$5n.$5P[this.$5n.$5P.length-1];if(a.StatusCode===46&&this.$Ur++<2){m.$8g();return}if(a.StatusCode){this.set_$s(0);this.$Af();var b,c,g,h,i,l=(i=WordViewer.Comments.$I.$kT(a.StatusCode,g={val:b},h={val:c}),b=g.val,c=h.val,i);if(!l)Common.$0.$3W(c);else{var e=new CommonUI.$t;e.set_$W(0);b&&e.$Og(WordViewerIntl.WordViewerStrings.l_LearnMore,b);e.$6g(c,CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,l,null)}return}if(a.Refresh){this.set_$s(0);this.$Af();var d;switch(a.Refresh){case 1:Common.$0.$3W(5374018);d=WordViewerIntl.WordViewerStrings.l_CommentingNeedsRefresh;break;case 2:Common.$0.$3W(5374017);d=WordViewerIntl.WordViewerStrings.l_CommentingNeedsRefresh;break;default:d=WordViewerIntl.WordViewerStrings.l_GenericErrorOpen}var f=new CommonUI.$t;f.set_$W(1);f.$k(1,WordViewerIntl.WordViewerStrings.l_Reload);f.$LE(CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,d,this.$$d_$rb);return}this.$Ma=a.SharedLock;this.$HJ=true;Common.$0.$5.$N(863375655,2);this.$Af();if(!this.$Bx){this.$Bx=new Common.$p(3,2,6e5,this.$$d_$rP);Common.$0.$E.$i(this.$Bx)}},$rb:function(a){if(a===1){Common.$0.$5.$N(3259256685,2);Common.$5.$D2(1,window.location.href)}else{Common.$0.$5.$N(1637502579,2);this.set_$s(0)}},$jW:function(){if(WordViewer.DocumentData.$8.get_$lD()){var a=Common.$e.$LX("comments.xml");Common.$0.$2R.$CJ(a,1,null,null,true,2,this.$$d_$oG,this.$$d_$oF,null)}else this.$Gh=true},$oG:function(a){this.$Gh=true;if(!a.$g.$6f){Common.$0.$5.$N(2718896640,2);this.set_$s(0);this.$1l.$GA()}else{this.$24.$vS(a.$g.$6f);this.$Af()}Common.$0.$5.$N(159412208,2)},$oF:function(){this.set_$s(0);this.$Gh=true;this.$1l.$GA();Common.$0.$5.$N(3609945866,2)},$rP:function(){var a=new WordViewer.$2Q(3,this.$$d_$rO);this.$8Q=new WordViewer.$2d;this.$8Q.set_$6e(WordViewer.$29.$8d(WordViewer.App.$0.$3t,WordViewer.DocumentData.$8.get_$QN()));this.$8Q.$Y=1;a.$Il(this.$8Q);a.$8g()},$rO:function(b){if(Common.$0.$1X)return;if(this.$8Q.$7j===5){if(this.$7H){this.$S6();return}this.$7H=true;b.$8g();return}this.$7H=false;if(this.$8Q.$7j!==2||!this.$8Q.$5P){this.$S6();return}var a=this.$8Q.$5P[0];if(a.StatusCode){this.$S6();return}this.$lN()},$S6:function(){if(this.$6B)return;this.$6B=new CommonUI.$2X(CommonUIIntl.CommonUIStrings.l_NetworkProblemToast,true);WordViewer.App.get_$1().get_$AZ().$7R(this.$6B)},$lN:function(){if(!this.$6B)return;WordViewer.App.get_$1().get_$AZ().$G0(this.$6B);this.$6B.$F();this.$6B=null},$Af:function(){if(this.$Gh&&this.$EZ){this.$1l.$uH(this.$24.$k3());this.$1l.get_$Er()&&this.$1l.set_$Er(false)}},$LB:function(a,b,c,d,e){return this.$1l.$LB(a,b,c,d,e)},$cu:function(a,b,c,d,e){return this.$1l.$cu(a,b,c,d,e)}};WordViewer.Comments.$z=function(){this.$$d_$sv=Function.createDelegate(this,this.$sv);this.$$d_$iB=Function.createDelegate(this,this.$iB);this.$$d_$Zr=Function.createDelegate(this,this.$Zr);this.$$d_$o5=Function.createDelegate(this,this.$o5);this.$q=[];this.$2m=[];this.$Bt=[];this.$IC={};this.dispose=this.$F;Common.$0.$5.$C(3940382077,1,WordViewer.Comments.$z.$qo);WordViewer.App.get_$1().$z.$Jl=this.$$d_$o5;WordViewer.App.get_$1().$z.$4(1,this.$$d_$Zr,null)};WordViewer.Comments.$z.$hi=function(){return WordViewer.Comments.$18.$Wg(WordViewer.App.$0.$OP,null,WordViewer.Comments.$18.$aN)};WordViewer.Comments.$z.$uf=function(c,d){var a=c,b=d;return a.$11.$8===b.$11.$8?0:a.$11.$8.toLowerCase().localeCompare(b.$11.$8.toLowerCase())};WordViewer.Comments.$z.$Qc=function(a){if(a.$I4<=0){a.set_$Y(3);WordViewer.Comments.$z.$LG(WordViewerIntl.WordViewerStrings.l_GenericErrorSave,5374014);return false}else{a.$I4--;a.set_$Y(0);Common.$0.$5.$N(4156131848,2);return true}};WordViewer.Comments.$z.$LG=function(b,c){if(Common.$0.get_$9().$4T!==1){var a=new CommonUI.$t;a.set_$W(0);a.$6g(c,CommonUIIntl.CommonUIStrings.l_DefaultDialogTitle,b,null)}};WordViewer.Comments.$z.$kU=function(b,a){switch(b){case 1:a.val=5373993;return WordViewerIntl.WordViewerStrings.l_GenericErrorSave;case 14:a.val=5373994;return WordViewerIntl.WordViewerStrings.l_GenericErrorSave;case 7:a.val=5373995;return WordViewerIntl.WordViewerStrings.l_AccessDeniedSave;case 36:a.val=5373996;return WordViewerIntl.WordViewerStrings.l_OldProductDigitalSignatureSave;case 9:a.val=5373997;return WordViewerIntl.WordViewerStrings.l_DocumentProtectionSettingsCommentSave;case 30:a.val=5373998;return WordViewerIntl.WordViewerStrings.l_DocumentPasswordEncryptedSave;case 31:a.val=5373999;return WordViewerIntl.WordViewerStrings.l_CheckedOutSave;case 17:a.val=5374e3;return WordViewerIntl.WordViewerStrings.l_RequiresCheckoutSave;case 16:a.val=5374001;return WordViewerIntl.WordViewerStrings.l_LockedForOfflineCheckoutSave;case 11:a.val=5374002;return WordViewerIntl.WordViewerStrings.l_LockedByOtherInterfaceSave;case 57:a.val=5374003;return WordViewerIntl.WordViewerStrings.l_NumberOfCoauthorsReachedMaxSave;case 47:a.val=5374004;return WordViewerIntl.WordViewerStrings.l_DocumentChangedErrorSave;case 59:a.val=5374005;return WordViewerIntl.WordViewerStrings.l_DocxCoherencyErrorSave;case 12:a.val=5374006;return WordViewerIntl.WordViewerStrings.l_CorruptFileSave;case 61:a.val=5374007;return WordViewerIntl.WordViewerStrings.l_DocumentMarkedFinalSave;case 38:a.val=5374008;return WordViewerIntl.WordViewerStrings.l_PreReleaseFile;case 35:a.val=5374009;return WordViewerIntl.WordViewerStrings.l_GenericErrorSave;case 39:a.val=5374010;return WordViewerIntl.WordViewerStrings.l_GenericErrorSave;case 33:a.val=5374011;return WordViewerIntl.WordViewerStrings.l_GenericErrorSave;default:a.val=5373994;return WordViewerIntl.WordViewerStrings.l_GenericErrorSave}};WordViewer.Comments.$z.$Wq=function(a){var b=a.getTime(),c=a.getTimezoneOffset();return b-c*60*1e3};WordViewer.Comments.$z.$qo=function(){WordViewer.App.$Oi=true;return 32};WordViewer.Comments.$z.prototype={$1i:null,$C7:null,$BX:null,$Aw:null,$7H:false,$Hc:20,$NV:null,$F:function(){for(var b=this.$q.length,a=0;a<b;a++)this.$q[a].$F();this.$q=[]},$vS:function(q){if(!q)return;var j=q.selectNodes("/comments/comment"),k,c,e,l,f,m,g,r=j.length;this.$q=[];for(var h=0;h<r;h++){var a=j[h];k=WordViewer.$6.$1Y(a,"id");c=WordViewer.$6.$1Y(a,"author");e=WordViewer.$6.$1Y(a,"date");l=WordViewer.$6.$1Y(a,"replyId");f=WordViewer.$6.$1Y(a,"done");m=WordViewer.$6.$1Y(a,"guardId");g=WordViewer.$6.$1Y(a,"page");if(!c)c=WordViewerIntl.WordViewerStrings.l_CommentAuthorUnknown;for(var i=a.selectNodes("p"),n=new Array(i.length),d=0;d<i.length;d++)n[d]=i[d].text;var b=null;if(e){b=new Date(parseInt(e));b.setMinutes(b.getMinutes()+b.getTimezoneOffset())}var o=false;if(f&&f.toLowerCase()==="true")o=true;var p=-1;if(g)p=parseInt(g);var s=new WordViewer.Comments.$18(k,m,c,b,l,o,n,p);Array.add(this.$q,s)}},$KT:function(){this.$1i&&this.$1i.$KT();this.$C7&&this.$C7.$KT()},$5k:function(a){this.$4k();a.set_$DD(1);this.$1i=a;if(a.$39)for(var d=Array.indexOf(this.$q,a),b=d-1;b>=0;b--){var c=this.$q[b];if(c.$8===a.$39){c.set_$DD(2);this.$C7=c;break}}},$Rn:function(){if(!this.$q.length)return null;var a=null;if(!this.$1i)a=this.$q[0];else a=this.$Xr(this.$1i);if(!a)return null;this.$5k(a);return a},$Ro:function(){if(!this.$q.length)return null;var a=null;if(!this.$1i)a=this.$q[this.$q.length-1];else a=this.$Xs(this.$1i);if(!a)return null;this.$5k(a);return a},$4k:function(){if(this.$1i){this.$1i.set_$DD(0);this.$1i=null}if(this.$C7){this.$C7.set_$DD(0);this.$C7=null}},$eg:function(a,f){WordViewer.Comments.$I.get_$0().set_$s(2);this.$BX=a;a.$1F=f.$1F;for(var b=-1,c=0;c<this.$q.length;c++){var d=this.$q[c];if(d.$1F<a.$1F)continue;if(d.$1F===a.$1F){var e=WordViewer.Comments.$I.get_$0().$4V.$k6(d.$8);if(e&&e.$6F)if(WordViewer.Comments.$i.$WZ(e,f)<=0)continue}b=c;break}if(b===-1)b=this.$q.length;Array.insert(this.$q,b,a)},$hI:function(d){var e=this.$FR(d);WordViewer.Comments.$I.get_$0().set_$s(2);var a=WordViewer.Comments.$18.$Wg(WordViewer.App.$0.$OP,d,e.$1F);this.$BX=a;for(var f=false,b=this.$q.length-1;b>=0;b--){var c=this.$q[b];if(c.$39===a.$39||c.$8===a.$39){Array.insert(this.$q,b+1,a);f=true;break}}return a},$WV:function(b){var a=[];b.set_$8c(0);Array.add(a,b);this.$RD(a,2);this.$BX=null},$JD:function(a){var b=[],e=Array.indexOf(this.$q,a),c=e;while(c<this.$q.length){var d=this.$q[c];if(d.$8===a.$8||d.$39===a.$8){Array.removeAt(this.$q,c);Array.add(b,d)}else break}this.$RD(b,3);if(this.$BX===a)this.$BX=null;return b},$WK:function(c,e){var d=[],f=Array.indexOf(this.$q,c),b=f;while(b<this.$q.length){var a=this.$q[b];if(a.$8===c.$8||a.$39===c.$8){a.set_$PS(e);Array.add(d,a);b++}else break}this.$RD(d,e?0:1)},$k3:function(){return Array.clone(this.$q)},$FR:function(c){for(var a=0;a<this.$q.length;a++){var b=this.$q[a];if(b.$8===c)return b}return null},$Xr:function(b){var a=Array.indexOf(this.$q,b);return a===this.$q.length-1?null:this.$q[a+1]},$Xs:function(b){var a=Array.indexOf(this.$q,b);return!a?null:this.$q[a-1]},$RD:function(d,e){for(var a=0;a<d.length;a++){var b=d[a];if(b.get_$8c()===1&&e===3)continue;if(b.get_$G2()===3)continue;var c=new WordViewer.Comments.$41(b,e);c.set_$Y(0);Array.add(this.$2m,c)}this.$bl()},$bl:function(){if(this.$Zl()){this.$Aw=null;this.$bM()}else this.$ch()},$ch:function(){if(this.$Aw)Common.$0.$E.$RP(this.$Aw,15e3);else{this.$Aw=new Common.$p(4,1,15e3,this.$$d_$iB);Common.$0.$E.$i(this.$Aw)}},$Zl:function(){return!this.$Bt.length?true:false},$iB:function(){this.$Aw=null;this.$bl()},$bM:function(){this.$2m.sort(WordViewer.Comments.$z.$uf);var a=[],f=new WordViewer.$2Q(2,this.$$d_$sv),b=0;while(b<this.$2m.length&&a.length<this.$Hc-2){for(var h=this.$2m[b].$11,g=0,d=new Array(4),e=0;e<4;e++)d[e]=[];while(b<this.$2m.length){var c=this.$2m[b];if(c.$11.$8!==h.$8)break;if(!c.get_$Y()){Array.add(d[c.$Ly],c);g++}b++}if(g>0){var i=this.$hr(d,f,a);Array.addRange(a,i)}}if(a.length>0){this.$Bt=a;f.$8g()}},$hr:function(a,f,g){var b=[],c=WordViewer.Comments.$I.get_$0().$Ma;if(a[3].length===1){this.$DS(4,a[2]);this.$DS(4,a[0]);this.$DS(4,a[1]);var j=a[3][0];if(a[2].length===1){this.$DS(4,a[3]);return b}var n=this.$PH(f,3,j,c,g);j.set_$Y(1);Array.add(b,n);return b}if(a[2].length===1){var d=a[2][0],k=this.$PH(f,2,d,c,g);if(!k)d.set_$Y(0);else{d.set_$Y(1);Array.add(b,k)}}var h=a[0].length,i=a[1].length;this.$DS(4,a[0]);this.$DS(4,a[1]);if(h!==i){var l=h>i?0:1,e=a[l][0],m=this.$PH(f,l,e,c,g);if(!m)e.set_$Y(0);else{e.set_$Y(1);Array.add(b,m)}}return b},$DS:function(c,b){for(var a=0;a<b.length;a++)b[a].set_$Y(c)},$PH:function(l,c,g,e,i){var a=g.$11,b=new WordViewer.$2d;if(c===3)b.set_$6e(WordViewer.$2o.$8d(WordViewer.App.$0.$3t,a.$74,e));else if(!c||c===1){if(!a.$74)return null;b.set_$6e(WordViewer.$2m.$8d(WordViewer.App.$0.$3t,a.$74||a.$8,a.get_$PS(),e))}else if(c===2&&a.$39){var d=this.$FR(a.$39);if(!d.$74)if(d.get_$G2()===3){g.set_$Y(3);return null}else return null;for(var f=0;f<i.length;f++){var h=i[f];if(WordViewer.$2N.isInstanceOfType(h.get_$6e())&&h.get_$6e().GuardParaId===d.$74)return null}var j=a.$5M[0];b.set_$6e(WordViewer.$2N.$8d(WordViewer.App.$0.$3t,j,d.$74,WordViewer.Comments.$z.$Wq(a.$BA),e,a.$8))}else if(c===2){var k=a.$5M[0];b.set_$6e(WordViewer.$2j.$8d(WordViewer.App.$0.$3t,k,a.$So,a.$Sn,WordViewer.Comments.$z.$Wq(a.$BA),e,a.$8))}else return null;b.$Y=1;l.$Il(b);this.$IC[b.get_$3Q().toString()]=g;return b},$sv:function(r){var j=false,d=false,b=0;while(b<this.$2m.length){var p=this.$2m[b];if(p.get_$Y()===3){Array.removeAt(this.$2m,b);continue}b++}for(var f=0;f<this.$Bt.length;f++){var e=this.$Bt[f],c=this.$IC[e.get_$3Q().toString()];if(e.$7j===5)if(this.$7H){c.set_$Y(3);WordViewer.Comments.$z.$LG(WordViewerIntl.WordViewerStrings.l_GenericErrorSave,5374013);continue}else{this.$7H=true;r.$8g();return}if(e.$7j!==2||!e.$5P){Common.$0.$5.$N(516537638,2);d=!!(d|WordViewer.Comments.$z.$Qc(c));continue}var a=e.$5P[e.$5P.length-1];if(a.StatusCode===33){if(this.$Hc<=2){c.set_$Y(3);WordViewer.Comments.$z.$LG(WordViewerIntl.WordViewerStrings.l_GenericErrorSave,5374011);continue}if(!j){j=true;this.$Hc=parseInt(Math.max(Math.floor(this.$Hc/2),1))}c.set_$Y(0);d=!!(d|WordViewer.Comments.$z.$Qc(c));continue}if(a.StatusCode===46||a.StatusCode===59){c.set_$Y(0);d=!!(d|WordViewer.Comments.$z.$Qc(c));continue}if(a.StatusCode){c.set_$Y(3);var g,h,i,q=(i=WordViewer.Comments.$z.$kU(a.StatusCode,h={val:g}),g=h.val,i);WordViewer.Comments.$z.$LG(q,g);a.StatusCode===61&&WordViewer.Comments.$I.get_$0().set_$s(0);continue}Common.$0.$5.$N(1991982245,2);c.set_$Y(2);if(a.$P4===18){var k=a,l=this.$FR(k.CommId);if(l)l.$74=k.ParaId}else if(a.$P4===17){var m=a,n=this.$FR(m.CommId);if(n)n.$74=m.ParaId}}this.$Bt=[];this.$IC={};this.$7H=false;b=0;while(b<this.$2m.length){var o=this.$2m[b];if(o.get_$Y()===2||o.get_$Y()===4){Array.removeAt(this.$2m,b);continue}b++}(d||this.$Q1())&&this.$ch()},$Zr:function(a){this.$NV=null;if(!this.$Q1()||WordViewer.App.$Oi)return;if(this.$Zl()){Common.$0.$1X=true;this.$bM();Common.$0.$1X=false}if(this.$Q1()||this.$me()){this.$NV=WordViewerIntl.WordViewerStrings.l_NavigateAway;a.$JV.rawEvent.returnValue=WordViewerIntl.WordViewerStrings.l_NavigateAway;return}},$o5:function(){return this.$NV},$Q1:function(){for(var a=0;a<this.$2m.length;a++){var b=this.$2m[a];if(!b.get_$Y()||b.get_$Y()===1)return true}return false},$me:function(){for(var a=0;a<this.$2m.length;a++){var b=this.$2m[a];if(b.get_$Y()===3)return true}return false}};WordViewer.Comments.$2C=function(c){this.$$d_$nm=Function.createDelegate(this,this.$nm);this.$$d_$nn=Function.createDelegate(this,this.$nn);this.$$d_$nq=Function.createDelegate(this,this.$nq);this.$$d_$nr=Function.createDelegate(this,this.$nr);this.$$d_$np=Function.createDelegate(this,this.$np);this.$$d_$4k=Function.createDelegate(this,this.$4k);this.$$d_$R3=Function.createDelegate(this,this.$R3);this.$$d_$r1=Function.createDelegate(this,this.$r1);this.$$d_$Ro=Function.createDelegate(this,this.$Ro);this.$$d_$Rn=Function.createDelegate(this,this.$Rn);this.$$d_$en=Function.createDelegate(this,this.$en);this.$$d_$Q3=Function.createDelegate(this,this.$Q3);this.$$d_$GN=Function.createDelegate(this,this.$GN);this.dispose=this.$F;var b=this.$hk();c.appendChild(b);WordViewer.App.get_$1().$z.$4(0,this.$$d_$GN,null);Common.$2.get_$Z()&&Common.$2.get_$7Y()<=4&&WordViewer.App.get_$1().$Ap.$RE(this.$1Q);var a=Common.$0.$5;a.$C(2493123577,1,this.$$d_$Q3);a.$C(2423504651,1,this.$$d_$en);a.$C(1873541548,1,this.$$d_$Rn);a.$C(4242021840,1,this.$$d_$Ro);a.$1G(847427893,1,this.$$d_$r1,8);this.$bX()};WordViewer.Comments.$2C.$J0=function(){Common.$0.$5.$N(2493123577,2);return true};WordViewer.Comments.$2C.prototype={$1M:null,$1Q:null,$53:null,$9b:null,$Sl:false,$M3:false,$Ib:null,$Sk:false,get_$Er:function(){return this.$Sk},set_$Er:function(a){this.$Sk=a;!a&&this.$R3();return a},$F:function(){Common.$2.get_$Z()&&Common.$2.get_$7Y()<=4&&WordViewer.App.get_$1().$Ap.$SO(this.$1Q);var a=WordViewer.App.get_$1().$1H;a.$A("click",this.$53,WordViewer.Comments.$2C.$J0);a.$A("click",this.$9b,this.$$d_$R3);a.$A("click",this.$1M,this.$$d_$4k);this.$1M=null;this.$53=null;this.$1Q=null;this.$9b=null},$cY:function(){this.$1Q.innerText="";var a=WordViewer.$6.$1c("div","","CommentPaneEmpty1");a.innerText=WordViewerIntl.WordViewerStrings.l_CommentPaneEmpty1;this.$1Q.appendChild(a);if(WordViewer.Comments.$I.get_$0().get_$s()){var b=WordViewer.$6.$1c("div","","CommentPaneEmpty2");b.innerText=WordViewerIntl.WordViewerStrings.l_CommentPaneEmpty2;this.$1Q.appendChild(b)}},$GA:function(){this.$1Q.innerText="";var a=WordViewer.$6.$1c("div","","CommentPaneEmpty1");a.innerText=WordViewerIntl.WordViewerStrings.l_CommentPaneError;this.$1Q.appendChild(a)},$uR:function(){this.$1Q.innerText="";var a=WordViewer.$6.$1c("div","","");a.style.textAlign="center";var b=document.createElement("img");b.className="CommentPaneLoading";b.src=Common.$R.$AA("progress.gif");a.appendChild(b);var c=WordViewer.$6.$1c("div","","CommentPaneLoadingText");c.innerText=WordViewerIntl.WordViewerStrings.l_CommentLoading;a.appendChild(c);this.$1Q.appendChild(a)},$uH:function(b){Common.$5.$F2(this.$1Q);if(!b.length)this.$cY();else for(var a=0;a<b.length;a++){var c=b[a],d=!a?null:b[a-1];(!a||d.$1F<c.$1F)&&this.$1Q.appendChild(this.$Wm(c.$1F));this.$1Q.appendChild(c.$RK())}this.$M3=true;this.$At();if(this.$Ib){this.$Ib.$Ce();this.$Ib=null}},$5k:function(a){if(!this.$M3){this.$Ib=a;return}a.$Ce()},$bL:function(b){var e=WordViewer.Comments.$I.get_$0().$24.$Xs(b),c=WordViewer.Comments.$I.get_$0().$24.$Xr(b);!e&&!c&&Common.$5.$F2(this.$1Q);var k=!e||e.$1F<b.$1F,g=!c||c.$1F>b.$1F,l=k&&g,a=null;if(c){a=c.get_$J2();if(g)a=a.previousSibling}var d=b.$RK(),f=[],h=0,i=0;if(a){i=a.offsetTop;this.$1Q.insertBefore(d,a)}else this.$1Q.appendChild(d);Array.add(f,d);if(l){var j=this.$Wm(b.$1F);this.$1Q.insertBefore(j,d);Array.add(f,j)}if(a)h=a.offsetTop-i;WordViewer.$P.$fH(f,a,h,this.$$d_$np,this.$$d_$nr);b.$Ce()},$np:function(a){Common.$5.$gi(a.get_$M());Common.$C.$bH(a.get_$M())},$nr:function(a){a.get_$M().style.marginTop="";Common.$C.$bH(a.get_$M())},$rk:function(i){for(var a=[],d=null,e=null,b=0;b<i.length;b++){var f=i[b];if(!b)e=f.get_$J2().previousSibling;if(b===i.length-1){var k=f.get_$J2().nextSibling;Sys.UI.DomElement.containsCssClass(e,"CommentPageRowDivider")&&(!k||Sys.UI.DomElement.containsCssClass(k,"CommentPageRowDivider"))&&Array.add(a,e)}d=f.get_$J2();Array.add(a,d)}var j=0,c=d.nextSibling;if(c){for(var l=c.offsetTop,g=0;g<a.length;g++)a[g].style.display="none";j=c.offsetTop-l;for(var h=0;h<a.length;h++)a[h].style.display=""}WordViewer.$P.$fC(a,c,j,this.$$d_$nq,this.$$d_$nr)},$nq:function(a){a.get_$M().parentNode.removeChild(a.get_$M());!this.$1Q.childNodes.length&&this.$cY()},$KT:function(){this.$At()},$hk:function(){var a=WordViewer.$6.$1c("div","CommentPane","CommentPane"),c=this.$Wk(),d=this.$hZ(),b=WordViewer.$6.$1c("div","CommentPaneSurface","CommentPaneSurface");if(!WordViewer.App.$0.get_$7S()){Sys.UI.DomElement.addCssClass(a,"DisableSelection");a.setAttribute("Unselectable","on")}a.appendChild(c);a.appendChild(d);a.appendChild(b);this.$1M=a;this.$1Q=b;this.$Kn(this.$9b,this.$1Q);this.$u1();WordViewer.App.get_$1().$1H.$4("click",a,this.$$d_$4k,null);this.$uR();return a},$Wk:function(){var b=WordViewer.$6.$1d("div","CommentPaneHeader","CommentPaneHeader"),c=WordViewer.$6.$1d("span","CommentPaneTitle","PaneTitle CommentPaneTitle UIFontLight");c.innerText=WordViewerIntl.WordViewerStrings.L_OpenCommentPane;var a=WordViewer.$6.$8e("CloseCommentPane","CommentPaneCloseButton",WordViewerIntl.WordViewerStrings.L_Close,"ClosePaneGlyph_16x16x32",false);if(Common.$0.get_$d())Sys.UI.DomElement.addCssClass(a,"FloatLeft");else Sys.UI.DomElement.addCssClass(a,"FloatRight");WordViewer.App.get_$1().$1H.$4("click",a,WordViewer.Comments.$2C.$J0,null);b.appendChild(c);b.appendChild(a);this.$53=a;return b},$hZ:function(){var a=WordViewer.$6.$1d("div","CommentPaneControls","CommentPaneControls"),b=WordViewer.$6.$8e("CommentPaneNewComment","CommentPaneNewComment",WordViewerIntl.WordViewerStrings.l_CommentNewCommentButton,"CommentNew_16x16x32");a.appendChild(b);WordViewer.App.get_$1().$1H.$4("click",b,this.$$d_$R3,null);this.$9b=b;if(!WordViewer.App.$0.get_$LZ())a.style.display="none";return a},$Wm:function(b){var a=WordViewer.$6.$1c("div","","CommentPageRowDivider");!this.$Sl&&Sys.UI.DomElement.addCssClass(a,"CommentPageRowDividerFirst");this.$Sl=true;a.innerText=String.format(WordViewerIntl.WordViewerStrings.l_CommentPanePageLabel,b);return a},$At:function(){var a=$get("CommentPaneNewComment");this.$Kn(a,this.$1Q)},$Kn:function(b,a){if(!WordViewer.Comments.$I.get_$0()||WordViewer.Comments.$I.get_$0().get_$s()!==1||!this.$M3)WordViewer.$6.$L3(b,false);else WordViewer.$6.$L3(b,true);if(WordViewer.Comments.$I.get_$0()&&WordViewer.Comments.$I.get_$0().get_$s()===2){Sys.UI.DomElement.addCssClass(a,"CommentInProgress");Sys.UI.DomElement.removeCssClass(a,"Interactive")}else{Sys.UI.DomElement.addCssClass(a,"Interactive");Sys.UI.DomElement.removeCssClass(a,"CommentInProgress")}if(!WordViewer.Comments.$I.get_$0()||!WordViewer.Comments.$I.get_$0().get_$s())Sys.UI.DomElement.addCssClass(a,"ReadOnly");else Sys.UI.DomElement.removeCssClass(a,"ReadOnly")},$u1:function(){var c=Common.$E.$0(),a=c.$o("CommentPane");a.$21="app";Common.$0.get_$9().$1H.$Of("CommentPane",this.$1M);var b=this;a.$Ev(function(){if(b.$9b.disabled)b.$53.focus();else b.$9b.focus()});var d=this;a.$Vh(function(){WordViewer.Comments.$I.get_$0().get_$s()!==2&&WordViewer.Comments.$I.get_$0().$4k()});Common.$0.get_$9().$1j.$Eu("CommentPane");a.$c(Common.$G.$f(38,0),4242021840);a.$c(Common.$G.$f(40,0),1873541548)},$4k:function(){Common.$E.$0().$2Q("CommentPane");WordViewer.Comments.$I.get_$0()&&WordViewer.Comments.$I.get_$0().get_$s()!==2&&WordViewer.Comments.$I.get_$0().$4k();return true},$R3:function(){if(this.$9b.disabled)return true;Common.$E.$0().$2Q("CommentPane");WordViewer.Comments.$I.get_$0().$ef();return true},$GN:function(){this.$bX()},$bX:function(){var c=WordViewer.App.$0.$I.$PC-WordViewer.App.$0.$I.$gw;this.$1M.style.width=c+"px";if(WordViewer.App.get_$1().$4W)this.$1M.style.visibility="visible";this.$1M.style.top="0";if(WordViewer.App.get_$1().$4W){if(WordViewer.App.get_$1().$HL)Sys.UI.DomElement.addCssClass(this.$1M,"msosp-touch-dyn");else Sys.UI.DomElement.removeCssClass(this.$1M,"msosp-touch-dyn");WordViewer.$P.$Vo(this.$1M,true,this.$$d_$nn)}else WordViewer.$P.$Vo(this.$1M,false,this.$$d_$nm);var a=WordViewer.App.get_$1().$B.$AK(),b=this.$1Q.offsetTop;if(a>b)this.$1Q.style.height=a-b+"px";else this.$1Q.style.height="0px"},$nn:function(){this.$1M.style.visibility="visible"},$nm:function(){this.$1M.style.visibility="hidden"},$LB:function(e,f,d,g,b){if(d===1)return WordViewer.App.$6Y()?32:8;if(!WordViewer.App.get_$1().$4W){WordViewer.Selection.$W.get_$0().$Ju();var a=0;if(b){var c=b;a=c.$Jz}WordViewer.App.get_$1().$LB(a)}Common.$0.get_$9().$1j.$Eo("CommentPane");WordViewer.Comments.$I.get_$0().$lg();WordViewer.App.get_$1().$1L.$3r();return 32},$en:function(f,g,e,h,a){if(e===1)return WordViewer.App.$6Y()&&WordViewer.Comments.$I.get_$0().get_$s()===1?32:8;if(!WordViewer.App.get_$1().$4W){var b=0;if(a){var d=a;b=d.$Jz}var c=new Common.$2M(a,b);this.set_$Er(true);Common.$0.$5.$t(3510751882,2,c)}else this.$R3();return 32},$Q3:function(d,e,c){if(c===1)return 32;var b=WordViewer.App.get_$1();if(b.$4W){WordViewer.Selection.$W.get_$0().$Ju();b.$Q3();WordViewer.Comments.$I.get_$0().$qO()}var a=Common.$E.$0();a.get_$1r()&&a.get_$1r().$18==="CommentPane"&&a.$2H(a.$BB);Common.$0.get_$9().$1j.$FC("CommentPane");WordViewer.App.get_$1().$1L.$3r();return 32},$cu:function(a,b,c,d,e){return WordViewer.App.get_$1().$4W?this.$Q3(a,b,c,d,e):this.$LB(a,b,c,d,e)},$r1:function(d,e,b,f,c){if(b===1)return 32;var a=c;a.On=WordViewer.App.get_$1().$4W;return 32},$Rn:function(b,c,a){if(a===1)return 32;WordViewer.Comments.$I.get_$0().$Rn();return 32},$Ro:function(b,c,a){if(a===1)return 32;WordViewer.Comments.$I.get_$0().$Ro();return 32}};WordViewer.Comments.$41=function(a,b){this.$I4=5;this.$11=a;this.$Ly=b;this.$2D=0};WordViewer.Comments.$41.prototype={$11:null,$Ly:0,$2D:0,get_$Y:function(){return this.$2D},set_$Y:function(a){this.$2D=a;this.$11.set_$G2(a);return a},toString:function(){return String.format("Type:{0} State:{1} Com:[{2}] R:[{3}]",this.$Ly,this.$2D,this.$11.toString(),this.$I4)}};WordViewer.Comments.$2n=function(a){this.$$d_$oJ=Function.createDelegate(this,this.$oJ);this.$$d_$pY=Function.createDelegate(this,this.$pY);this.$$d_$Zw=Function.createDelegate(this,this.$Zw);this.$$d_$a4=Function.createDelegate(this,this.$a4);this.$$d_$pk=Function.createDelegate(this,this.$pk);this.$$d_$oB=Function.createDelegate(this,this.$oB);this.$$d_$aB=Function.createDelegate(this,this.$aB);this.$$d_$oU=Function.createDelegate(this,this.$oU);this.$$d_$oQ=Function.createDelegate(this,this.$oQ);this.$$d_$oI=Function.createDelegate(this,this.$oI);this.dispose=this.$F;if(Common.$2.get_$3R())this.$KR=6;this.$11=a;this.$RK()};WordViewer.Comments.$2n.$i4=function(a){if(!a||isNaN(a.getDate()))return"";var c=WordViewer.Comments.$I.get_$0().get_$ct(),b=new Date;if(b.getFullYear()!==a.getFullYear()||b.getMonth()!==a.getMonth()||b.getDate()!==a.getDate())c=String.format(WordViewerIntl.WordViewerStrings.l_CommentLongDateFormat,WordViewer.Comments.$I.get_$0().get_$i3(),WordViewer.Comments.$I.get_$0().get_$ct());return a.localeFormat(c)};WordViewer.Comments.$2n.prototype={$KR:4,$11:null,$Ub:0,$7u:null,$O:null,$Dn:null,$BG:null,$ME:null,$C0:null,$9n:null,$13:null,$CB:null,$44:null,$F:function(){var a=WordViewer.App.get_$1().$1H;a.$A("click",this.$O,this.$$d_$oI);a.$A("click",this.$Dn,this.$$d_$oQ);a.$A("click",this.$BG,this.$$d_$oU);a.$A("click",this.$9n,this.$$d_$aB);this.$7u&&a.$A("click",this.$7u,this.$$d_$oB);this.$C0&&a.$A("click",this.$C0,this.$$d_$pk);var b=WordViewer.App.get_$1().$31;if(this.$13){b.$A("keypress",this.$13,this.$$d_$a4);b.$A("keyup",this.$13,this.$$d_$a4);if(Common.$2.get_$Z()){var c=WordViewer.App.get_$1().$8v;c.$A("compositionstart",this.$13,this.$$d_$Zw);c.$A("compositionend",this.$13,this.$$d_$Zw);c.$A("compositionupdate",this.$13,this.$$d_$Zw)}Common.$m.get_$0().$A("paste",this.$13,this.$$d_$pY)}b.$A("keyup",this.$O,this.$$d_$oJ);this.$O=null;this.$Dn=null;this.$C0=null;this.$BG=null;this.$ME=null;this.$9n=null;this.$7u=null;this.$13=null;this.$CB=null;this.$44=null},$Ce:function(){Common.$E.$0().$2Q("CommentPane");this.$O.focus()},$jk:function(){Common.$E.$0().$2Q("CommentPaneTextbox");!Common.$2.get_$Z()&&this.$13.focus();var a=WordViewer.Comments.$I.get_$0().$1l.$1Q,b=Common.$5.$kj(a,this.$O);if(b.y+this.$O.clientHeight>a.scrollTop+a.clientHeight)a.scrollTop=b.y+this.$O.clientHeight-a.clientHeight},$jd:function(){Sys.UI.DomElement.removeCssClass(this.$O,"NewComment");this.$7u.style.display="none";this.$13.style.display="none";this.$13.blur();this.$9n.blur();Common.$E.$0().$RJ("CommentPaneTextbox");Common.$G.get_$0().$A("keypress",this.$13,this.$$d_$a4);Common.$G.get_$0().$A("keyup",this.$13,this.$$d_$a4);if(Common.$2.get_$Z()){var a=WordViewer.App.get_$1().$8v;a.$A("compositionstart",this.$13,this.$$d_$Zw);a.$A("compositionend",this.$13,this.$$d_$Zw);a.$A("compositionupdate",this.$13,this.$$d_$Zw)}Common.$m.get_$0().$A("paste",this.$13,this.$$d_$pY);var b=$get(this.$1u("cn"));b.removeChild(this.$13);b.removeChild(this.$CB);this.$13=null;this.$CB=null;this.$44=null;this.$Vc($get(this.$1u("cn")));this.$At();this.$Ce()},$At:function(){var d=$get(this.$1u("ch")),e=$get(this.$1u("ct")),a=$get(this.$1u("ci")),f=$get(this.$1u("cn")),b=$get(this.$1u("cf")),c=$get(this.$1u("cfa"));this.$Kn(a,b,c,this.$BG,this.$ME,this.$O)},$RK:function(){var b=WordViewer.$6.$1c("div",this.$1u("cc"),"CommentContainer");b.tabIndex=0;if(this.$11.$39)b.className+=" Reply1";var e=WordViewer.$6.$1c("div",this.$1u("ch"),"CommentHeaderRow"),l=WordViewer.$6.$1c("span",this.$1u("ca"),"CommentAuthor UIFontBold");l.innerText=this.$11.$Lo;e.appendChild(l);var g=WordViewer.$6.$1c("span",this.$1u("ct"),"CommentDate");g.innerText=WordViewer.Comments.$2n.$i4(this.$11.$BA);Sys.UI.DomElement.addCssClass(g,Common.$0.get_$d()?"FloatLeft":"FloatRight");e.appendChild(g);var r=WordViewer.$6.$1c("span",this.$1u("ci"),"CommentStatusIcon");e.appendChild(r);var h=null;if(this.$11.get_$8c()===1){h=WordViewer.$6.$8e(this.$1u("cl"),"CommentCancelButton",WordViewerIntl.WordViewerStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",false);Sys.UI.DomElement.addCssClass(h,Common.$0.get_$d()?"FloatLeft":"FloatRight");e.appendChild(h)}var i=WordViewer.$6.$1c("div",this.$1u("cn"),"CommentContent"),a=null,j=null,c=null;if(this.$11.get_$8c()===1){a=WordViewer.$6.$1c("textarea",this.$1u("ce"),"CommentTextEntry UIFont");a.rows=this.$KR;a.cols=50;i.appendChild(a);j=WordViewer.$6.$1c("div","","CommentTextMeasurementContainer");c=WordViewer.$6.$1c("textarea","","CommentTextEntry UIFont");c.rows=1;c.cols=50;c.style.visibility="hidden";c.spellcheck=false;j.appendChild(c);i.appendChild(j)}else this.$Vc(i);var m=WordViewer.$6.$1c("div","","CommentFooterRow"),f=WordViewer.$6.$1c("span",this.$1u("cf"),""),s=WordViewer.$6.$8e(this.$1u("cr"),"CommentReplyButton CommentFooterButton",WordViewerIntl.WordViewerStrings.l_CommentReplyButton,"CommentReply_16x16x32",false);f.appendChild(s);var k=WordViewer.$6.$8e(this.$1u("cd"),"CommentDoneButton CommentFooterButton",WordViewerIntl.WordViewerStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",false),t=k.childNodes[0].childNodes[0];f.appendChild(k);var u=WordViewer.$6.$8e(this.$1u("cx"),"CommentDeleteButton CommentFooterButton",WordViewerIntl.WordViewerStrings.l_CommentDeleteButton,"Delete_16x16x32",false);f.appendChild(u);m.appendChild(f);var n=WordViewer.$6.$1c("span",this.$1u("cfa"),""),o=WordViewer.$6.$8e(this.$1u("cs"),"CommentSaveButton",WordViewerIntl.WordViewerStrings.l_CommentSaveCommentButton,null);WordViewer.$6.$L3(o,false);n.appendChild(o);m.appendChild(n);this.$Kn(r,f,n,k,t,b);if(!WordViewer.App.$0.get_$7S()){l.setAttribute("Unselectable","on");g.setAttribute("Unselectable","on")}b.appendChild(e);b.appendChild(i);b.appendChild(m);this.$O=b;this.$BG=k;this.$ME=t;this.$Dn=u;this.$C0=s;this.$9n=o;this.$13=a;this.$CB=j;this.$44=c;this.$7u=h;var d=WordViewer.App.get_$1().$1H;d.$4("click",this.$O,this.$$d_$oI);d.$4("click",this.$BG,this.$$d_$oU);d.$4("click",this.$Dn,this.$$d_$oQ);d.$4("click",this.$9n,this.$$d_$aB);d.$4("click",this.$C0,this.$$d_$pk);this.$7u&&d.$4("click",this.$7u,this.$$d_$oB);var p=WordViewer.App.get_$1().$31;p.$4("keyup",b,this.$$d_$oJ);if(a){p.$4("keypress",a,this.$$d_$a4);p.$4("keyup",a,this.$$d_$a4);if(Common.$2.get_$Z()){var q=WordViewer.App.get_$1().$8v;q.$4("compositionstart",a,this.$$d_$Zw,null);q.$4("compositionend",a,this.$$d_$Zw,null);q.$4("compositionupdate",a,this.$$d_$Zw,null)}Common.$m.get_$0().$4("paste",a,this.$$d_$pY);this.$u3()}},$Kn:function(c,b,d,f,e,a){switch(this.$11.get_$G2()){case 0:case 1:this.$ca(c,0);break;case 2:case 4:c.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(a,"SaveFailure");Sys.UI.DomElement.addCssClass(a,"NoReply");this.$ca(c,1)}if(this.$11.get_$PS()){Sys.UI.DomElement.addCssClass(a,"CommentIsDone");e.className=Common.$N.$2F("CheckboxChecked_16x16x32")}else{Sys.UI.DomElement.removeCssClass(a,"CommentIsDone");e.className=Common.$N.$2F("CheckboxUnchecked_16x16x32")}if(this.$11.get_$8c()===1){Sys.UI.DomElement.addCssClass(a,"NewComment");Sys.UI.DomElement.addCssClass(a,"SelectedComment");c.style.display="none";b.style.display="none";d.style.display="inline"}else if(this.$11.get_$DD()===1){Sys.UI.DomElement.addCssClass(a,"SelectedComment");Sys.UI.DomElement.removeCssClass(a,"SelectedParentComment");if(WordViewer.Comments.$I.get_$0().get_$s()===1&&this.$11.get_$G2()!==3)b.style.display="inline";else b.style.display="none";d.style.display="none"}else if(this.$11.get_$DD()===2){Sys.UI.DomElement.removeCssClass(a,"SelectedComment");Sys.UI.DomElement.addCssClass(a,"SelectedParentComment");b.style.display="inline";d.style.display="none"}else{Sys.UI.DomElement.removeCssClass(a,"SelectedComment");Sys.UI.DomElement.removeCssClass(a,"SelectedParentComment");b.style.display="inline";d.style.display="none"}},$ca:function(a,d){Common.$5.$Iy(a);switch(d){case 0:var b=document.createElement("img");b.alt=WordViewerIntl.WordViewerStrings.l_CommentProgressTooltip;b.src=Common.$R.$AA("progress16.gif");a.appendChild(b);break;case 1:var c=Common.$N.$3D(16,16,"Risks_16x16x32","",true,WordViewerIntl.WordViewerStrings.l_CommentFailTooltip);a.appendChild(c)}a.style.display="inline-block"},$Vc:function(g){var a=this.$11.$5M;if(a.length===1&&a[0])a=a[0].split("\n");for(var d=a,e=d.length,b=0;b<e;++b){var f=d[b],c=WordViewer.$6.$1c("p","","CommentContentPara");c.innerText=f||"\u00a0";!WordViewer.App.$0.get_$7S()&&c.setAttribute("Unselectable","on");g.appendChild(c)}},$u3:function(){var a=Common.$E.$0(),b=a.$o("CommentPaneTextbox");Common.$0.get_$9().$1H.$Of("CommentPaneTextbox",this.$13);b.$c(Common.$G.$f(83,2),336231556)},$1u:function(a){return a+"_"+this.$11.$8},$oI:function(){this.$11.$aC();return true},$oJ:function(a){if(a.$P.keyCode===13){this.$11.$aC();return true}return false},$oQ:function(){if(this.$Dn.disabled)return true;this.$11.$oP();return true},$oU:function(){if(this.$BG.disabled)return true;this.$11.$q1();return true},$pk:function(){if(this.$C0.disabled)return true;this.$11.$pj();return true},$aB:function(){if(this.$9n.disabled)return true;this.$11.$pr(this.$13.value);return true},$oB:function(){if(this.$7u.disabled)return true;this.$11.$Qx();return true},$a4:function(a){if(a.$P.ctrlKey&&a.$P.keyCode===13){this.$13.value.length>0&&this.$aB(null);return true}if(a.$P.keyCode===27)return true;var b=a.$5Y==="keypress"&&a.$P.charCode===13;this.$R6(b);return false},$Zw:function(){this.$R6(false);return false},$pY:function(){var a=this,b=new Common.$p(1,1,0,function(){a.$R6(false)});Common.$0.$E.$i(b);return false},$R6:function(c){WordViewer.$6.$L3(this.$9n,this.$13.value.length>0);if(Common.$2.get_$3R())return;if(this.$CB.clientWidth!==this.$13.clientWidth)this.$CB.style.width=this.$13.clientWidth+"px";this.$44.value=this.$13.value+"___";if(this.$Ub>this.$13.value.length)this.$44.rows=1;if(Common.$2.get_$3R())var d=this.$44.scrollHeight;var a=0,b=Number.MAX_VALUE;while(1<=(a=this.$44.scrollHeight-this.$44.clientHeight)&&a<b){b=a;this.$44.rows++;if(Common.$2.get_$3R())var e=this.$44.scrollHeight}if(this.$44.rows<this.$KR)this.$13.rows=this.$KR;else{if(c)this.$44.rows++;this.$13.rows=this.$44.rows}this.$Ub=this.$13.value.length}};Type.registerNamespace("WordViewer.Highlight");WordViewer.Highlight.$5i=function(){};WordViewer.Highlight.$5i.registerInterface("WordViewer.Highlight.$5i");WordViewer.Highlight.$5r=function(a,b,c,d){this.$2T=a;this.$Ec=b;this.$8=c;this.$V=d};WordViewer.Highlight.$5r.prototype={$2T:null,$Ec:0,$8:null,$V:0,get_$ZK:function(){return this.$2T.$2s},set_$ZK:function(a){this.$2T.$2s=a;return a},get_$cw:function(){return this.$2T.$1V},set_$cw:function(a){this.$2T.$1V=a;return a},get_$Sd:function(){return this.$2T.$2d},set_$Sd:function(a){this.$2T.$2d=a;return a},get_$lG:function(){return this.$2T.$5C},set_$lG:function(a){this.$2T.$5C=a;return a},get_$Ey:function(){return this.$2T},set_$Ey:function(a){this.$2T=a;return a},get_$Yo:function(){return this.$8},set_$Yo:function(a){this.$8=a;return a},get_$qK:function(){return this.$V},set_$qK:function(a){this.$V=a;return a}};WordViewer.Highlight.$h=function(){};WordViewer.Highlight.$h.get_$0=function(){if(!WordViewer.Highlight.$h.$D&&!WordViewer.Highlight.$h.$2q){WordViewer.Highlight.$h.$2q=true;WordViewer.Highlight.$h.$D=WordViewer.Highlight.$h.$hd(0,WordViewer.App.get_$1().$B.$1h.$3A);WordViewer.Highlight.$h.$2q=false}return WordViewer.Highlight.$h.$D};WordViewer.Highlight.$h.$hd=function(a,b){switch(a){case 0:return new WordViewer.Highlight.$4N(b)}return null};WordViewer.Highlight.$4O=function(c,a,b,d){WordViewer.Highlight.$4O.initializeBase(this,[c,a,b,d]);this.$1m=document.createElement("div");this.$1m.id=b;this.$5V=1;this.$ey(a)};WordViewer.Highlight.$4O.prototype={$1m:null,$5V:0,$ey:function(a){this.$Ec=a;switch(a){case 1:Sys.UI.DomElement.addCssClass(this.$1m,"CommonHighlight WACHighlight");break;case 2:Sys.UI.DomElement.addCssClass(this.$1m,"WACActiveHighlight");break;case 3:Sys.UI.DomElement.addCssClass(this.$1m,"CommonHighlight WACCommentHighlight");break;case 0:default:Sys.UI.DomElement.addCssClass(this.$1m,"WACSelection")}},$rq:function(a){if(a===this.$Ec&&a===2)this.$Ec=1;else this.$Ec=-1;switch(a){case 1:Sys.UI.DomElement.removeCssClass(this.$1m,"CommonHighlight WACHighlight");break;case 2:Sys.UI.DomElement.removeCssClass(this.$1m,"WACActiveHighlight");break;case 3:Sys.UI.DomElement.removeCssClass(this.$1m,"CommonHighlight WACCommentHighlight");break;case 0:default:Sys.UI.DomElement.removeCssClass(this.$1m,"WACSelection")}},$L8:function(c,a,b){this.$V=a;this.$5V=b;this.$2T=this.get_$Ey();this.$bN()},$WR:function(){return Common.$C.$WQ(this.$1m,false,true)},$lL:function(){WordViewer.$P.$fF(this.$1m)},$uO:function(){this.$bN();WordViewer.$P.$fL(this.$1m)},$bN:function(){if(Common.$0.get_$d())this.$1m.style.right=WordViewer.DocumentData.$8.$FS(this.$V,this.$5V)-(Math.round(this.$2T.$2s*this.$5V)+Math.round(this.$2T.$2d*this.$5V))+"px";else this.$1m.style.left=WordViewer.DocumentData.$8.$6U(this.$V,this.$5V,false)+Math.round(this.$2T.$2s*this.$5V)+"px";this.$1m.style.top=WordViewer.DocumentData.$8.$2y(this.$V,this.$5V)+Math.round(this.$2T.$1V*this.$5V)+"px";this.$1m.style.width=Math.round(this.$2T.$2d*this.$5V)+"px";this.$1m.style.height=Math.round(this.$2T.$5C*this.$5V)+"px"}};WordViewer.Highlight.$4N=function(a){this.$12=a};WordViewer.Highlight.$4N.prototype={$12:null,$Km:function(a){if(!a)return;this.$12.removeChild(a.$1m)},$PU:function(b,c,d,e){var a=new WordViewer.Highlight.$4O(b,c,d,e);this.$12.appendChild(a.$1m);return a},$Z4:function(){return true},$h0:function(c,s,t){var e=WordViewer.App.$0.$I.$PT,i=parseFloat(c.attributes.getNamedItem("l").nodeValue),j=parseFloat(c.attributes.getNamedItem("t").nodeValue),o=parseFloat(c.attributes.getNamedItem("w").nodeValue),r=parseFloat(c.attributes.getNamedItem("h").nodeValue),a=c.attributes.getNamedItem("a")?parseInt(c.attributes.getNamedItem("a").nodeValue):0,b=!!c.attributes.getNamedItem("rtl"),k=!!c.attributes.getNamedItem("gr"),A="",D=c.attributes.getNamedItem("cw");if(D)A=c.attributes.getNamedItem("cw").nodeValue;else return WordViewer.Highlight.$1Z.$Pa(c,s,t);var d=0,h=0,B=0,H=c.childNodes[0].data.length,f=Number.NaN,g=Number.NaN;if(!b&&!a){f=i/e;g=j/e}else if(a===270&&!b||a===90&&b){f=(i+o)/e;g=(j+r)/e}else if(a===90&&!b||a===270&&b){f=i/e;g=j/e}else if(isNaN(f)){f=(i+o)/e;g=(j+r)/e}var E=A.split(";"),l=[];Array.addRange(l,E);Array.removeAt(l,l.length-1);var F=s-B,C=o/e,p=0,q=0,u,v,w,m=(w=WordViewer.Highlight.$1Z.$WD(k,F,C,l,u={val:p},v={val:q},false),p=u.val,q=v.val,w);if(k)d=g+m;else if(!a)if(!b)d=f+m;else d=f-m;else if(a===270&&!b||a===90&&b)d=g-m;else if(a===90&&!b||a===270&&b)d=g+m;var G=t-B,x,y,z,n=(z=WordViewer.Highlight.$1Z.$WD(k,G,C,l,x={val:p},y={val:q},true),p=x.val,q=y.val,z);if(k)h=d+n;else if(!a)if(!b)h=d+n;else h=d-n;else if(a===270&&!b||a===90&&b)h=d-n;else if(a===90&&!b||a===270&&b)h=d+n;return WordViewer.Highlight.$1Z.$io(a,b,k,i,j,o,r,d,h,c,s,t)},get_$nT:function(){return true}};Type.registerNamespace("WordViewer.Search");WordViewer.Search.$43=function(a,b,c){this.$TB=a;this.$Un=b;this.$Ul=c};WordViewer.Search.$43.prototype={$Un:0,$Ul:0,$TB:null};WordViewer.Search.$49=function(){this.$5w=[];this.dispose=this.$F};WordViewer.Search.$49.prototype={$I3:0,$80:null,$81:null,$2o:null,$F:function(){if(this.$81){Array.clear(this.$5w);this.$81=null}this.$80=null},$7i:function(){this.$I3=Number.NaN;this.$2o=null;if(this.$80){Sys.UI.DomElement.removeCssClass(this.$80,"WACSelectedResult");this.$80=null}if(this.$81){Sys.UI.DomElement.removeCssClass(this.$81,"WACActiveContext");this.$81=null}Array.clear(this.$5w)},$G5:function(a,f,g){this.$I3=g;this.$2o=a;var b=a.get_$3Q();this.$P6();if(this.$80){Sys.UI.DomElement.removeCssClass(this.$80,"WACSelectedResult");Sys.UI.DomElement.removeCssClass(this.$81,"WACActiveContext")}this.$80=f;this.$81=WordViewer.Search.$o.$FU(f,2);Sys.UI.DomElement.addCssClass(this.$80,"WACSelectedResult");Sys.UI.DomElement.addCssClass(this.$81,"WACActiveContext");this.$tE(b);WordViewer.Search.$X.get_$0().$ZO(a.$V,b,this.$5w.length>0);var c=a.$5a(),d=a.$Cm();if(isNaN(c)&&isNaN(d))return;var e=new WordViewer.Controls.$1c(c,d);Common.$0.$5.$t(702693766,2,e);WordViewer.App.$0.$2Z&&WordViewer.$J.$Kz(a.$V,e,2)},$tE:function(j){var c=0,d=0,e=0,i=new RegExp("(\\d+)-(\\d+)"),g=i.exec(j);d=Number.parseInvariant(g[1]);e=Number.parseInvariant(g[2]);var h=WordViewer.Search.$X.get_$0(),a=h.$Ps(d);if(!a)return;var b=a[e];if(!b)return;var f=b.$75[c];while(f){this.$Pk(f);c++;a=h.$Ps(d);b=a[e];f=b.$75[c]}},$Pk:function(a){this.$5w[this.$5w.length]=a;var b=a.$WR();a.$ey(2);if(b){var c=a.$1m;WordViewer.$P.$fE(b,c)}},$P6:function(){if(this.$5w){for(var a=0;a<this.$5w.length;++a){var b=this.$5w[a],c=b.$WR();b.$rq(2);if(c){var d=b.$1m;WordViewer.$P.$fA(c,d)}}Array.clear(this.$5w)}}};WordViewer.Search.$X=function(a,b){this.$$d_$KZ=Function.createDelegate(this,this.$KZ);this.$$d_$ZA=Function.createDelegate(this,this.$ZA);this.dispose=this.$F;this.$3k=new WordViewer.Search.$58;this.$64=new WordViewer.Search.$4Q(b);this.$2o=new WordViewer.Search.$49;this.$3i=new WordViewer.Search.$T(a);Common.$0.$5.$C(2936063169,1,this.$$d_$KZ)};WordViewer.Search.$X.get_$0=function(){if(!WordViewer.Search.$X.$D&&!WordViewer.Search.$X.$2q){WordViewer.Search.$X.$2q=true;WordViewer.Search.$X.$D=new WordViewer.Search.$X(WordViewer.App.get_$1().$B.$1w,WordViewer.App.get_$1().$B.$1h.$3A);WordViewer.Search.$X.$2q=false}return WordViewer.Search.$X.$D};WordViewer.Search.$X.prototype={$2o:null,$3k:null,$3i:null,$64:null,$ZA:function(){return!this.$3k.$Ba},get_$mN:function(){return this.$3k.$Dz},get_$GI:function(){return this.$3k.get_$GI()},$F:function(){if(this.$2o){this.$2o.$F();this.$2o=null}if(this.$64){this.$64.$F();this.$64=null}if(this.$3i){this.$3i.$F();this.$3i=null}if(this.$3k){this.$3k.$F();this.$3k=null}},$jp:function(){this.$2o.$7i();this.$64.$u2();this.$G5(0)},$LJ:function(a){Common.$0.$G.$4o(8813,1);a=WordViewer.Search.$o.$nb(a);if(!a)return;var b=WordViewer.Search.$o.$8O;if(a.length===b.length){var c=new RegExp(a,"i"),d=c.exec(b);if(d)return}WordViewer.Search.$o.$8O=a;this.$3i.$LJ();this.$3k.$LJ();this.$64.$7i()},$cm:function(){this.$2o.$7i();this.$3k.$7i();this.$64.$7i();this.$3i.$7i();WordViewer.Search.$o.$8O=""},$X3:function(a){Common.$0.$G.$Vl(89404,a);Common.$0.$G.$tg(89528,a);Common.$0.$G.$th(89529,a);this.$3i.$X3(a)},$Kr:function(){if(this.$3k.$Ba&&!this.$3k.$Dz){this.$3k.$Kr();this.$3i.$Kr()}},$YS:function(){var a=this.$2o.$I3,b=this.get_$GI();this.$G5(a<b-1?a+1:0)},$YT:function(){var a=this.$2o.$I3;this.$G5(a>0?a-1:this.get_$GI()-1)},$G5:function(a){var b=this.get_$GI();if(a<0||a>=b)return;var c=this.$3k.$kk(a),d=this.$3i.$l8(a,b);this.$2o.$G5(c,d,a);Common.$E.$0().$2H("searchResults")},$KZ:function(e,f,g,h,d){var a=d;if(a.length===2&&a[0]&&a[1]){var c=a[0],b=a[1];this.$64.$KZ(c,b);this.$3k.$KZ(b)}return 32},$X4:function(a){this.$3i.$X4(a)},$P0:function(){return this.$3i.$P0()},$Xh:function(a,b){this.$3i.$Xh(a,b)},$Pk:function(a){this.$2o.$Pk(a)},$ZO:function(a,b,c){this.$64.$ZO(a,b,c)},$P6:function(){this.$2o.$P6()},$Ps:function(a){return this.$64.$Ps(a)},$LH:function(a,b,c,d,e){return this.$3i.$LH(a,b,c,d,e)},$cv:function(a,b,c,d,e){return this.$3i.$cv(a,b,c,d,e)}};WordViewer.Search.$T=function(m){this.$$d_$nx=Function.createDelegate(this,this.$nx);this.$$d_$ny=Function.createDelegate(this,this.$ny);this.$$d_$fn=Function.createDelegate(this,this.$fn);this.$$d_$jm=Function.createDelegate(this,this.$jm);this.$$d_$fl=Function.createDelegate(this,this.$fl);this.$$d_$jj=Function.createDelegate(this,this.$jj);this.$$d_$fm=Function.createDelegate(this,this.$fm);this.$$d_$jl=Function.createDelegate(this,this.$jl);this.$$d_$R5=Function.createDelegate(this,this.$R5);this.$$d_$tD=Function.createDelegate(this,this.$tD);this.$$d_$gn=Function.createDelegate(this,this.$gn);this.$$d_$nD=Function.createDelegate(this,this.$nD);this.$$d_$nA=Function.createDelegate(this,this.$nA);this.$$d_$jQ=Function.createDelegate(this,this.$jQ);this.$$d_$jE=Function.createDelegate(this,this.$jE);this.$$d_$gm=Function.createDelegate(this,this.$gm);this.$$d_$nC=Function.createDelegate(this,this.$nC);this.$$d_$n9=Function.createDelegate(this,this.$n9);this.$$d_$jP=Function.createDelegate(this,this.$jP);this.$$d_$jD=Function.createDelegate(this,this.$jD);this.$$d_$sX=Function.createDelegate(this,this.$sX);this.$$d_$go=Function.createDelegate(this,this.$go);this.$$d_$nE=Function.createDelegate(this,this.$nE);this.$$d_$nB=Function.createDelegate(this,this.$nB);this.$$d_$jR=Function.createDelegate(this,this.$jR);this.$$d_$jF=Function.createDelegate(this,this.$jF);this.$$d_$r2=Function.createDelegate(this,this.$r2);this.$$d_$qq=Function.createDelegate(this,this.$qq);this.$$d_$na=Function.createDelegate(this,this.$na);this.$$d_$Q4=Function.createDelegate(this,this.$Q4);this.$$d_$GN=Function.createDelegate(this,this.$GN);this.$$d_$tC=Function.createDelegate(this,this.$tC);this.$$d_$bs=Function.createDelegate(this,this.$bs);this.$4g=0;this.$37=0;this.$38=0;this.dispose=this.$F;var e=Common.$0.get_$d(),g=Common.$10.get_$0(),b=Common.$Y.get_$0(),h=Common.$G.get_$0(),i=Common.$m.get_$0();this.$1M=WordViewer.$6.$1d("div","WACSearchPane","FindPane");var j=this.$Wk(e,b),k=this.$hS(e,g,b,h);this.$2C=this.$ho(b,i);this.$Um=WordViewer.Search.$T.$hE("WACResultNavigator","WACResultNavigator");this.$1M.appendChild(j);this.$1M.appendChild(k);this.$1M.appendChild(this.$Um);this.$1M.appendChild(this.$2C);m.appendChild(this.$1M);Common.$2.get_$Z()&&Common.$2.get_$7Y()<=4&&WordViewer.App.get_$1().$Ap.$RE(this.$2C);this.$No=WordViewer.Search.$T.$hq();var l=Common.$E.$0(),c=l.$o("search");c.$21="app";var f=this;c.$Ev(function(){f.$1e.focus()});c.$Vi(this.$$d_$bs);c.$Vh(this.$$d_$tC);b.$Of("search",this.$1e);Common.$0.get_$9().$1j.$Eu("search");var a=Common.$E.$0().$o("searchResults");Common.$0.get_$9().$1j.$Eu("searchResults");a.$c(Common.$G.$f(38,0),1693292334);a.$c(Common.$G.$f(13,4),1693292334);a.$c(Common.$G.$f(40,0),716333338);a.$c(Common.$G.$f(13,0),716333338);a.$21="app";WordViewer.App.get_$1().$z.$4(0,this.$$d_$GN,null);var d=Common.$0.$5;d.$C(2599343072,1,this.$$d_$Q4);d.$C(716333338,1,this.$$d_$na);d.$C(1693292334,1,this.$$d_$qq);d.$1G(1289223352,1,this.$$d_$r2,8);this.$an()};WordViewer.Search.$T.$hE=function(b,c){var a=WordViewer.$6.$1d("a",null,b);a.id=c;a.href="javascript:;";a.setAttribute("onclick","return false;");return a};WordViewer.Search.$T.$hq=function(){var b=WordViewer.$6.$1d("div",null,"WACResultOutline"),a=WordViewer.$6.$1d("div",null,"WACSearchResult"),c=WordViewer.$6.$1d("span",null,null),d=WordViewer.$6.$1d("span",null,"WACContext"),e=WordViewer.$6.$1d("span",null,null);a.appendChild(c);a.appendChild(d);a.appendChild(e);b.appendChild(a);return b};WordViewer.Search.$T.$CY=function(b,a,c,d){a|=4;WordViewer.Search.$T.$4v(b,a,c,d);return true};WordViewer.Search.$T.$Cb=function(b,a,c,d){a&=~12;WordViewer.Search.$T.$4v(b,a,c,d);return true};WordViewer.Search.$T.$Qj=function(b,a,c,d){a|=8;WordViewer.Search.$T.$4v(b,a,c,d);return true};WordViewer.Search.$T.$Qk=function(b,a,c,d){a&=~8;a|=4;WordViewer.Search.$T.$4v(b,a,c,d);return true};WordViewer.Search.$T.$J0=function(){Common.$0.$5.$N(2599343072,2);return true};WordViewer.Search.$T.$4v=function(e,b,a,d){var c=e.firstChild;if(b&4&&a!=="Search"&&!(b&1))a+="Hover";if(b&2)a="cancel"+a;if(b&1){c.className=Common.$N.$2F(a+"Disabled"+d);c.style.cursor="default";return}c.className=Common.$N.$2F(a+d)};WordViewer.Search.$T.prototype={$No:null,$1M:null,$2C:null,$2u:null,$9k:null,$1e:null,$4c:null,$62:null,$EF:true,$NA:null,$1f:null,$41:null,$l:null,$m:null,$53:null,$Um:null,$F:function(){this.$P5();var a=Common.$10.get_$0(),b=Common.$Y.get_$0(),c=Common.$G.get_$0(),d=Common.$m.get_$0();if(!Common.$2.get_$Z()){a.$A("mouseover",this.$41,this.$$d_$jF);a.$A("mouseout",this.$41,this.$$d_$jR);a.$A("mousedown",this.$41,this.$$d_$nB);a.$A("mouseup",this.$41,this.$$d_$nE)}b.$A("click",this.$41,this.$$d_$go);b.$A("click",this.$53,WordViewer.Search.$T.$J0);b.$A("click",this.$2C,this.$$d_$sX);if(!Common.$2.get_$Z()){a.$A("mouseover",this.$l,this.$$d_$jD);a.$A("mouseout",this.$l,this.$$d_$jP);a.$A("mousedown",this.$l,this.$$d_$n9);a.$A("mouseup",this.$l,this.$$d_$nC)}b.$A("click",this.$l,this.$$d_$gm);if(!Common.$2.get_$Z()){a.$A("mouseover",this.$m,this.$$d_$jE);a.$A("mouseout",this.$m,this.$$d_$jQ);a.$A("mousedown",this.$m,this.$$d_$nA);a.$A("mouseup",this.$m,this.$$d_$nD)}b.$A("click",this.$m,this.$$d_$gn);c.$A("keydown",this.$1e,this.$$d_$tD);d.$A("scroll",this.$2C,this.$$d_$R5);Common.$A.$a(this.$m.firstChild,"focus",this.$$d_$jl);Common.$A.$a(this.$m.firstChild,"blur",this.$$d_$fm);Common.$A.$a(this.$l.firstChild,"focus",this.$$d_$jj);Common.$A.$a(this.$l.firstChild,"blur",this.$$d_$fl);Common.$A.$a(this.$1f.firstChild,"focus",this.$$d_$jm);Common.$A.$a(this.$1f.firstChild,"blur",this.$$d_$fn);Common.$2.get_$Z()&&Common.$2.get_$7Y()<=4&&WordViewer.App.get_$1().$Ap.$SO(this.$2C);if(this.$4c){this.$4c.$F();this.$4c=null}this.$No=null;this.$2u=null;this.$9k=null;this.$1f=null;this.$1e=null;this.$2C=null;this.$1M=null;this.$l=null;this.$m=null;this.$53=null},$Wk:function(c,d){var a=WordViewer.$6.$1d("div","","FindPaneHeader"),b=WordViewer.$6.$1d("span","WACSearchHeaderText","PaneTitle FindPaneTitle UIFontLight");b.innerText=WordViewerIntl.WordViewerStrings.l_HeaderText;this.$53=WordViewer.$6.$8e("FindPaneCloseButton","FindPaneCloseButton",WordViewerIntl.WordViewerStrings.L_Close,"ClosePaneGlyph_16x16x32",false);if(c)Sys.UI.DomElement.addCssClass(this.$53,"FloatLeft");else Sys.UI.DomElement.addCssClass(this.$53,"FloatRight");d.$4("click",this.$53,WordViewer.Search.$T.$J0,null);a.appendChild(b);a.appendChild(this.$53);return a},$hS:function(b,c,d,g){var a=WordViewer.$6.$1d("div","WACSearchControls","WACSearchControls"),e=this.$hp(b,c,d,g),f=this.$hm(b,c,d);a.appendChild(e);a.appendChild(f);return a},$ho:function(b,c){var a=WordViewer.$6.$1d("div","WACSearchResultsPane","WACSearchResultsPane");this.$2u=WordViewer.$6.$1d("div","WACSearchResultsScroller","WACSearchResultsScroller");this.$2u.innerText=WordViewerIntl.WordViewerStrings.l_SearchText;c.$4("scroll",a,this.$$d_$R5);b.$4("click",a,this.$$d_$sX,null);a.appendChild(this.$2u);return a},$hp:function(d,a,f,g){var e=d?"FloatRight":"FloatLeft",b=WordViewer.$6.$1d("div","WACSearchBoxDiv","WACSearchBoxDiv"),c=WordViewer.$6.$1d("span","WACSearchBoxSpan","WACSearchBoxSpan");this.$1e=WordViewer.$6.$1c("input","WACSearchBox","WACSearchBox UIFont "+e);this.$1e.setAttribute("maxLength",255);this.$1e.setAttribute("Autocomplete","off");this.$1e.type="text";this.$1e.value=WordViewerIntl.WordViewerStrings.l_SearchBoxValue;this.$1f=Common.$N.$3D(16,16,"Search_16x16x32","",true,WordViewerIntl.WordViewerStrings.l_SearchButtonTitleBegin);this.$1f.id="WACSearchButton";Sys.UI.DomElement.addCssClass(this.$1f,"WACSearchButton");this.$41=WordViewer.$6.$1d("div","WACSearchButtonFrame",d?"WACSearchButtonFrame FloatLeft":"WACSearchButtonFrame FloatRight");if(!Common.$2.get_$Z()){a.$4("mouseover",this.$41,this.$$d_$jF);a.$4("mouseout",this.$41,this.$$d_$jR);a.$4("mousedown",this.$41,this.$$d_$nB);a.$4("mouseup",this.$41,this.$$d_$nE)}f.$4("click",this.$41,this.$$d_$go);g.$4("keydown",this.$1e,this.$$d_$tD);c.appendChild(this.$1e);b.appendChild(c);this.$41.appendChild(this.$1f);b.appendChild(this.$41);return b},$hm:function(e,a,f){var g=e?"FloatLeft":"FloatRight",b=WordViewer.$6.$1d("div","WACInfoAndNavigation",""),c=WordViewer.$6.$1d("span","WACSearchProgressSpan"," "),d=WordViewer.$6.$1d("div","WACResultNavigationDiv","FindPaneNavigationControls "+g);this.$9k=WordViewer.$6.$1d("div","WACResultsInfo","WACResultsInfo");this.$9k.innerText="";Sys.UI.DomElement.addCssClass(c,"WACSearchProgressSpan");this.$4c=new CommonUI.$3U("");this.$4c.set_$ZB(true);this.$4c.set_$SH(WordViewerIntl.WordViewerStrings.l_ProgressTextSearching);this.$4c.$3g.style.display="none";c.appendChild(this.$4c.$3g);this.$62=WordViewer.$6.$1d("span","WACSearchMatchesText","WACSearchMatchesText");this.$62.style.display="none";c.appendChild(this.$62);this.$m=Common.$N.$3D(17,14,"","WACResultNavigation ",true,WordViewerIntl.WordViewerStrings.l_PrevButtonTitle);this.$m.id="WACPrevResultButtonSpan";this.$38=1;WordViewer.Search.$T.$4v(this.$m,this.$38,"ReorderUp","_17x14x24");this.$m.style.display="none";this.$l=Common.$N.$3D(17,14,"","WACResultNavigation ",true,WordViewerIntl.WordViewerStrings.l_NextButtonTitle);this.$l.id="WACNextResultButtonSpan";this.$37=1;WordViewer.Search.$T.$4v(this.$l,this.$37,"ReorderDown","_17x14x24");this.$l.style.display="none";if(!Common.$2.get_$Z()){a.$4("mouseover",this.$l,this.$$d_$jD);a.$4("mouseout",this.$l,this.$$d_$jP);a.$4("mousedown",this.$l,this.$$d_$n9);a.$4("mouseup",this.$l,this.$$d_$nC)}f.$4("click",this.$l,this.$$d_$gm);if(!Common.$2.get_$Z()){a.$4("mouseover",this.$m,this.$$d_$jE);a.$4("mouseout",this.$m,this.$$d_$jQ);a.$4("mousedown",this.$m,this.$$d_$nA);a.$4("mouseup",this.$m,this.$$d_$nD)}f.$4("click",this.$m,this.$$d_$gn);this.$Wl(d,this.$m);this.$Wl(d,this.$l);Sys.UI.DomElement.addCssClass(this.$m,"WACNavigationButton");Sys.UI.DomElement.addCssClass(this.$l,"WACNavigationButton");if(e){Sys.UI.DomElement.addCssClass(this.$m.parentNode,"FloatRight");Sys.UI.DomElement.addCssClass(this.$l.parentNode,"FloatLeft")}else{Sys.UI.DomElement.addCssClass(this.$m.parentNode,"FloatLeft");Sys.UI.DomElement.addCssClass(this.$l.parentNode,"FloatRight")}Common.$A.$h(this.$m.firstChild,"focus",this.$$d_$jl);Common.$A.$h(this.$m.firstChild,"blur",this.$$d_$fm);Common.$A.$h(this.$l.firstChild,"focus",this.$$d_$jj);Common.$A.$h(this.$l.firstChild,"blur",this.$$d_$fl);Common.$A.$h(this.$1f.firstChild,"focus",this.$$d_$jm);Common.$A.$h(this.$1f.firstChild,"blur",this.$$d_$fn);b.appendChild(d);b.appendChild(c);b.appendChild(this.$9k);return b},$Wl:function(b,c){var a=WordViewer.$6.$1d("div",null,"WACNavigationButtonFrame");b.appendChild(a);a.appendChild(c)},$Xh:function(m,e){var d=m.$5t,c=d.$TB,f=d.$Un,g=d.$Ul,b=e;if(!e){this.$m.style.display="inline-block";this.$l.style.display="inline-block"}else{var n=WordViewer.$6.$1d("div",null,"ResultDivider");this.$2u.appendChild(n)}var a=this.$No.cloneNode(true);a.id=b+"WACResultOutline";var h=WordViewer.Search.$o.$FU(a,0);h.id=b+"WACSearchResult";h.title=String.format(WordViewerIntl.WordViewerStrings.l_ResultToolTip,m.$V);var i=WordViewer.Search.$o.$FU(a,1);i.id=b+"preResult";i.innerText=c.substring(0,f);var j=WordViewer.Search.$o.$FU(a,2);j.id=b+"Result";j.innerText=c.substring(f,g);var k=WordViewer.Search.$o.$FU(a,3);k.id=b+"postResult";k.innerText=c.substring(g,c.length);if(e===1){var l=Common.$E.$0();if(l.get_$1r()&&l.get_$1r().$18==="search"){Common.$E.$0().$2H("searchResults");Common.$E.$GJ(WordViewer.App.get_$1().$B.$1w)}this.$37&=~1;WordViewer.Search.$T.$4v(this.$l,this.$37,"ReorderDown","_17x14x24");this.$38&=~1;WordViewer.Search.$T.$4v(this.$m,this.$38,"ReorderUp","_17x14x24")}this.$2u.appendChild(a);this.$NA=a},$l8:function(c,g){if(c+1===g)this.$2C.scrollTop=this.$2u.offsetHeight;if(!c)this.$2C.scrollTop=0;var a=$get(c+"WACResultOutline"),b=a.offsetTop,e=this.$2C.scrollTop,d=b+a.offsetHeight,f=e+this.$2C.offsetHeight;if(b<this.$2C.scrollTop)this.$2C.scrollTop=b;else if(d>f)this.$2C.scrollTop=d-this.$2C.offsetHeight;return a},$LJ:function(){this.$1e.blur();this.$4c.$3g.style.display="inline-block";this.$62.style.display="none";this.$2u.innerText="";this.$9k.innerText=String.format(WordViewerIntl.WordViewerStrings.l_ResultsInfoText,WordViewer.App.$0.$1A.$29);this.$P5();var a=this.$1f.firstChild;a.alt=WordViewerIntl.WordViewerStrings.l_SearchButtonTitleEnd;a.title=WordViewerIntl.WordViewerStrings.l_SearchButtonTitleEnd;this.$2u.parentNode.className="WACSearchResultsPane";this.$1f.title=WordViewerIntl.WordViewerStrings.l_SearchButtonTitleEnd;this.$4g|=2;WordViewer.Search.$T.$4v(this.$1f,this.$4g,"Search","_16x16x32")},$7i:function(){this.$4c.$3g.style.display="none";this.$62.style.display="none";this.$9k.innerText="";this.$P5();this.$2u.innerText=WordViewerIntl.WordViewerStrings.l_SearchText;this.$1e.value="";this.$2u.parentNode.className="WACSearchResultsPaneEmpty";var a=this.$1f.firstChild;a.alt=WordViewerIntl.WordViewerStrings.l_SearchButtonTitleBegin;a.title=WordViewerIntl.WordViewerStrings.l_SearchButtonTitleBegin;this.$4g&=~2;WordViewer.Search.$T.$4v(this.$1f,this.$4g,"Search","_16x16x32")},$Kr:function(){this.$4c.$3g.style.display="inline-block";this.$62.style.display="none"},$X3:function(a){this.$4c.$3g.style.display="none";this.$62.style.display="inline-block";if(!a)this.$62.innerText=WordViewerIntl.WordViewerStrings.l_ProgressTextNoResults;else if(a===1)this.$62.innerText=WordViewerIntl.WordViewerStrings.l_ProgressTextOneResult;else this.$62.innerText=String.format(WordViewerIntl.WordViewerStrings.l_ProgressTextManyResults,a)},$X4:function(a){this.$9k.innerText=String.format(WordViewerIntl.WordViewerStrings.l_NumberOfSearchedPages,a,WordViewer.App.$0.$1A.$29)},$P0:function(){return this.$NA?this.$2C.scrollTop+this.$2C.offsetHeight<this.$NA.offsetTop:false},$P5:function(){while(this.$2u.hasChildNodes())this.$2u.removeChild(this.$2u.lastChild);this.$2u.parentNode.className="WACSearchResultsPaneEmpty";this.$38|=1;WordViewer.Search.$T.$4v(this.$m,this.$38,"ReorderUp","_17x14x24");this.$m.style.display="none";this.$37|=1;WordViewer.Search.$T.$4v(this.$l,this.$37,"ReorderDown","_17x14x24");this.$l.style.display="none"},$na:function(b,c,a){if(a===1)return WordViewer.App.$6Y()?32:8;WordViewer.App.get_$1().$5F&&WordViewer.Search.$X.get_$0().$YS();return 32},$qq:function(b,c,a){if(a===1)return WordViewer.App.$6Y()?32:8;WordViewer.App.get_$1().$5F&&WordViewer.Search.$X.get_$0().$YT();return 32},$jF:function(){var a=Common.$0.get_$d()?"WACSearchButtonFrameHoverRTL":"WACSearchButtonFrameHover";Sys.UI.DomElement.addCssClass(this.$1f.parentNode,a);return WordViewer.Search.$T.$CY(this.$1f,this.$4g,"Search","_16x16x32")},$jm:function(){var a=Common.$0.get_$d()?"WACSearchButtonFrameHoverRTL":"WACSearchButtonFrameHover";Sys.UI.DomElement.addCssClass(this.$1f.parentNode,a);WordViewer.Search.$T.$CY(this.$1f,this.$4g,"Search","_16x16x32")},$jR:function(){var a=Common.$0.get_$d()?"WACSearchButtonFrameHoverRTL":"WACSearchButtonFrameHover";Sys.UI.DomElement.removeCssClass(this.$1f.parentNode,a);return WordViewer.Search.$T.$Cb(this.$1f,this.$4g,"Search","_16x16x32")},$fn:function(){var a=Common.$0.get_$d()?"WACSearchButtonFrameHoverRTL":"WACSearchButtonFrameHover";Sys.UI.DomElement.removeCssClass(this.$1f.parentNode,a);WordViewer.Search.$T.$Cb(this.$1f,this.$4g,"Search","_16x16x32")},$nB:function(){return WordViewer.Search.$T.$Qj(this.$1f,this.$4g,"Search","_16x16x32")},$nE:function(){return WordViewer.Search.$T.$Qk(this.$1f,this.$4g,"Search","_16x16x32")},$go:function(){if(!(this.$4g&2))!this.$EF&&WordViewer.Search.$X.get_$0().$LJ(this.$1e.value);else WordViewer.Search.$X.get_$0().$cm();return true},$jD:function(){this.$37!==1&&Sys.UI.DomElement.addCssClass(this.$l.parentNode,"WACNavigationButtonFrameHover");return WordViewer.Search.$T.$CY(this.$l,this.$37,"ReorderDown","_17x14x24")},$jj:function(){this.$37!==1&&Sys.UI.DomElement.addCssClass(this.$l.parentNode,"WACNavigationButtonFrameHover");WordViewer.Search.$T.$CY(this.$l,this.$37,"ReorderDown","_17x14x24")},$jP:function(){Sys.UI.DomElement.removeCssClass(this.$l.parentNode,"WACNavigationButtonFrameHover");return WordViewer.Search.$T.$Cb(this.$l,this.$37,"ReorderDown","_17x14x24")},$fl:function(){Sys.UI.DomElement.removeCssClass(this.$l.parentNode,"WACNavigationButtonFrameHover");WordViewer.Search.$T.$Cb(this.$l,this.$37,"ReorderDown","_17x14x24")},$n9:function(){return WordViewer.Search.$T.$Qj(this.$l,this.$37,"ReorderDown","_17x14x24")},$nC:function(){return WordViewer.Search.$T.$Qk(this.$l,this.$37,"ReorderDown","_17x14x24")},$gm:function(){!(this.$37&1)&&WordViewer.Search.$X.get_$0().$YS();return true},$jE:function(){this.$38!==1&&Sys.UI.DomElement.addCssClass(this.$m.parentNode,"WACNavigationButtonFrameHover");return WordViewer.Search.$T.$CY(this.$m,this.$38,"ReorderUp","_17x14x24")},$jl:function(){this.$38!==1&&Sys.UI.DomElement.addCssClass(this.$m.parentNode,"WACNavigationButtonFrameHover");WordViewer.Search.$T.$CY(this.$m,this.$38,"ReorderUp","_17x14x24")},$jQ:function(){Sys.UI.DomElement.removeCssClass(this.$m.parentNode,"WACNavigationButtonFrameHover");return WordViewer.Search.$T.$Cb(this.$m,this.$38,"ReorderUp","_17x14x24")},$fm:function(){Sys.UI.DomElement.removeCssClass(this.$m.parentNode,"WACNavigationButtonFrameHover");WordViewer.Search.$T.$Cb(this.$m,this.$38,"ReorderUp","_17x14x24")},$nA:function(){return WordViewer.Search.$T.$Qj(this.$m,this.$38,"ReorderUp","_17x14x24")},$nD:function(){return WordViewer.Search.$T.$Qk(this.$m,this.$38,"ReorderUp","_17x14x24")},$gn:function(){!(this.$38&1)&&WordViewer.Search.$X.get_$0().$YT();return true},$sX:function(d){this.$1e.blur();Common.$E.$GJ(WordViewer.App.get_$1().$B.$1w);var b=d.get_$w(),c=b.id,a=parseInt(c);if(!isNaN(a))WordViewer.Search.$X.get_$0().$G5(a);else if(!WordViewer.Search.$X.get_$0().get_$GI())return false;else Common.$E.$0().$2H("searchResults");return true},$R5:function(){var a=WordViewer.Search.$X.get_$0();!a.get_$mN()&&!a.$ZA()&&!this.$P0()&&a.$Kr();return false},$bs:function(){if(this.$EF){this.$EF=false;this.$1e.value=""}Sys.UI.DomElement.addCssClass(this.$1e,"WACSearchBoxQuery");this.$1e.select()},$tC:function(){this.$EF=!this.$1e.value;if(this.$EF){this.$1e.value=WordViewerIntl.WordViewerStrings.l_SearchBoxValue;Sys.UI.DomElement.removeCssClass(this.$1e,"WACSearchBoxQuery")}},$GN:function(){this.$an()},$an:function(){var b=true,a=null;if(WordViewer.App.get_$1().$5F){this.$1M.style.visibility="visible";if(WordViewer.App.get_$1().$HU)Sys.UI.DomElement.addCssClass(this.$1M,"msosp-touch-dyn");else Sys.UI.DomElement.removeCssClass(this.$1M,"msosp-touch-dyn");a=this.$$d_$ny}else{b=false;a=this.$$d_$nx}var d=WordViewer.App.$0.$I.$Rm,c=WordViewer.App.get_$1().$B.$AK();this.$2C.style.height=c>this.$2C.offsetTop?c-this.$2C.offsetTop+"px":"0px";this.$1M.style.width=d+"px";WordViewer.$P.$fD(this.$1M,b,a)},$ny:function(){this.$1M.style.visibility="visible"},$nx:function(){this.$1M.style.visibility="hidden"},$tD:function(c){var a=false,b=c.$P.keyCode;if(b===13){WordViewer.Search.$X.get_$0().$LJ(this.$1e.value);a=true}return a},$LH:function(e,f,d,g,b){if(d===1)return WordViewer.App.$6Y()?32:8;if(!WordViewer.App.get_$1().$5F){WordViewer.Selection.$W.get_$0().$Ju();var a=0;if(b){var c=b;a=c.$Jz}this.$1e.value="";WordViewer.Search.$o.$8O="";WordViewer.App.get_$1().$LH(a)}this.$bs(null,null);Common.$0.get_$9().$1j.$Eo("search");Common.$E.$0().$2H("search");if(!this.$2u.children.length)this.$2u.parentNode.className="WACSearchResultsPaneEmpty";Common.$0.get_$9().$1j.$Eo("search");Common.$E.$0().$2H("search");WordViewer.App.get_$1().$1L.$3r();return 32},$Q4:function(e,f,d){if(d===1)return 32;var b=WordViewer.App.get_$1();if(b.$5F){WordViewer.Selection.$W.get_$0().$Ju();b.$Q4();this.$1e.value="";WordViewer.Search.$X.get_$0().$cm()}var a=Common.$E.$0();if(a.get_$1r()){var c=a.get_$1r().$18;(c==="search"||c==="searchResults")&&a.$2H(a.$BB)}Common.$0.get_$9().$1j.$FC("search");Common.$0.get_$9().$1j.$FC("searchResults");WordViewer.App.get_$1().$1L.$3r();return 32},$cv:function(a,b,c,d,e){return WordViewer.App.get_$1().$5F?this.$Q4(a,b,c,d,e):this.$LH(a,b,c,d,e)},$r2:function(d,e,b,f,c){if(b===1)return 32;var a=c;a.On=WordViewer.App.get_$1().$5F;return 32}};WordViewer.Search.$2z=function(a,b,c,d,e){this.dispose=this.$F;this.$5t=a;this.$V=b;this.$Ti=c;this.$VF=e;this.$5I=d};WordViewer.Search.$2z.$fw=function(c,k,d,h){var i=h-d,a,b;if(i>=100){a=d;b=h}else{a=Math.max(0,d+Math.ceil(i/2)-50);b=Math.min(c.length,a+100);a=Math.max(0,b-100);var e;if(a&&c.charAt(a-1)!==" "){e=Math.min(d,a+10);for(var f=a;f<e;++f)if(c.charAt(f)===" "){a=f+1;break}}if(b!==c.length&&c.charAt(b)!==" "){e=Math.max(h,b-10);for(var g=b-1;g>=e;--g)if(c.charAt(g)===" "){b=g;break}}}var j=c.substring(a,b);return new WordViewer.Search.$43(j,d-a,h-a)};WordViewer.Search.$2z.prototype={$5t:null,$V:0,$Ti:0,$5I:null,$VF:0,get_$3Q:function(){return String.format("{0}-{1}",this.$V,this.$Ti)},$F:function(){this.$5I=null},$5a:function(){var b=WordViewer.App.get_$1().$B,a=b.$1W(),g=WordViewer.DocumentData.$8.$2y(this.$V,a),d=b.$5a(),c=g+this.$5I.$1V*a;if(c<d)return Math.round(c-a*this.$5I.$5C*WordViewer.App.$0.$I.$bt);var e=b.$Jg(),h=d+e,f=c+this.$5I.$5C*a;return f>h?Math.round(f+this.$5I.$5C*WordViewer.App.$0.$I.$bt*a-e):Number.NaN},$Cm:function(){var c=WordViewer.App.get_$1().$B,a=c.$1W(),b=c.$Cm(),e=c.$5b(),j=b+e;if(Common.$0.get_$d()){var f=WordViewer.DocumentData.$8.$FS(this.$V,a),g=f-this.$5I.$2s*a,h=f-(this.$5I.$2s+this.$5I.$2d)*a;b=Math.abs(b);if(h>b)return Math.round(g-WordViewer.App.$0.$I.$Kx);if(g<b)return Math.round(h-WordViewer.App.$0.$I.$Kx)}else{var k=WordViewer.DocumentData.$8.$6U(this.$V,a,false),d=k+this.$5I.$2s*a,i=d+this.$5I.$2d*a;if(d<b)return Math.round(d-WordViewer.App.$0.$I.$Kx);if(i>j)return Math.round(i-e+WordViewer.App.$0.$I.$Kx)}return Number.NaN}};WordViewer.Search.$o=function(){};WordViewer.Search.$o.$nb=function(d){for(var c=[],a,b=0;b<d.length;++b){a=d.charAt(b);if(a==="["||a==="\\"||a==="^"||a==="$"||a==="."||a==="|"||a==="+"||a==="("||a===")"||a==="?"||a==="*")c[b]=String.format("\\{0}",a);else if(a==="'"||a==="\u2018"||a==="\u2019")c[b]="['\u2018\u2019]";else if(a==='"'||a==="\u201c"||a==="\u201d")c[b]='["\u201c\u201d]';else if(a==="-"||a==="\u2013"||a==="\u2014")c[b]="[-\u2013\u2014]";else if(a===" "||a==="\u2003"||a==="\u2002"||a===" "||a==="\u00a0"||a==="\u3000")c[b]="[ \u2003\u2002 \u3000]";else if(a==="\u2026")c[b]="\\.\\.\\.";else if(a==="\u0640")c[b]="\u0640*";else c[b]=a;c[b]+="\u0640*"}var e=c.join(""),f=new RegExp("(\\\\.\\\\.\\\\.)","g");return e.replace(f,"(\\.\\.\\.|\u2026)")};WordViewer.Search.$o.$al=function(a,b,c){if(!a)return;a.$L8(a.get_$Ey(),b,c)};WordViewer.Search.$o.$YL=function(d){for(var b=[],c,a=0;a<d.length;++a){c=d[a];b[a]=c.data}return b.join("")};WordViewer.Search.$o.$FU=function(a,b){switch(b){case 0:return a.firstChild;case 1:return a.firstChild.childNodes[0];case 2:return a.firstChild.childNodes[1];case 3:return a.firstChild.childNodes[2]}return null};WordViewer.Search.$58=function(){this.$$d_$aT=Function.createDelegate(this,this.$aT);this.$$d_$vj=Function.createDelegate(this,this.$vj);this.$3j=[];this.dispose=this.$F};WordViewer.Search.$58.prototype={$Ba:true,$6C:null,$6D:0,$7y:0,$Dz:true,$4a:null,$EO:0,$B6:0,$B7:0,get_$GI:function(){return this.$3j.length},$LJ:function(){this.$7i();this.$Dz=false;this.$Ba=false;this.$7y=0;this.$Jk()},$7i:function(){this.$un();this.$gk();this.$Ba=true;this.$6D=0;this.$Dz=true;this.$4a=null},$Kr:function(){if(this.$6D){this.$Ba=false;Common.$0.$G.$4o(89406,1);this.$Jk()}},$Jk:function(){this.$6D++;WordViewer.App.get_$1().$1B.$vY(this.$6D);this.$6C=new Common.$p(3,1,WordViewer.App.$0.$I.$bu,this.$$d_$vj);Common.$0.$E.$i(this.$6C)},$vj:function(){var a=WordViewer.App.get_$1().$1B.$7V(this.$6D);if(a){this.$4a=a.selectNodes("descendant::P");this.$EO=0;if(!this.$4a.length){this.$Jk();return}else this.$6C=new Common.$p(3,1,WordViewer.App.$0.$I.$bu,this.$$d_$aT)}Common.$0.$E.$i(this.$6C)},$aT:function(){this.$B6=0;this.$B7=0;var b=WordViewer.App.$0.$I;while(this.$EO<this.$4a.length&&this.$B6<b.$ZX&&this.$B7<b.$ZW)this.$aS();if(this.$EO<this.$4a.length)Common.$0.$E.$i(this.$6C);else{var c=WordViewer.App.get_$1().$B,a=WordViewer.Search.$X.get_$0();a.$X4(this.$6D);this.$7y=0;var d=WordViewer.DocumentData.$8.get_$5i();if(this.$6D===d){this.$6C=null;this.$Dz=true;a.$X3(this.$3j.length)}else if(!(this.$6D%WordViewer.App.$0.$I.$tG)&&this.$6D>=c.$Ji()&&a.$P0()){this.$Ba=true;this.$6C=null;Common.$0.$G.$4o(89405,1)}else this.$Jk()}},$aS:function(){var b=this.$4a[this.$EO];if(!b.selectSingleNode("ancestor::P")){var a=b.selectNodes("descendant::T/text()"),c=WordViewer.Search.$o.$YL(a);a.length&&this.$YU(c,a);this.$B7++;this.$B6+=c.length}this.$EO++},$YU:function(l,b){var c,d,g,h=new RegExp(WordViewer.Search.$o.$8O,"ig"),i=WordViewer.Search.$X.get_$0(),m=parseInt(b[0].selectSingleNode("ancestor::Page").attributes.getNamedItem("id").nodeValue),e=0,a=0;while(g=h.exec(l)){c=g.index;d=h.lastIndex;for(var f=0,n=WordViewer.Search.$2z.$fw(l,g[0],c,d),j=null;e<b.length;++e){var p=b[e];f=a+p.data.length;if(a<d&&f>c){j=WordViewer.Highlight.$1Z.$Pa(b[e].parentNode,c-a,Math.min(f-a,d-a));break}a=f}var o=parseInt(WordViewer.$6.$1Y(b[0].parentNode,"id")),k=new WordViewer.Search.$2z(n,m,this.$7y,j,o);this.$3j[this.$3j.length]=k;this.$7y++;i.$Xh(k,this.$3j.length-1);this.$3j.length===1&&i.$jp()}},$un:function(){if(this.$6C){Common.$0.$E.$2x(this.$6C);this.$6C=null}WordViewer.App.get_$1().$1B&&WordViewer.App.get_$1().$1B.$rp()},$gk:function(){for(var a=0;a<this.$3j.length;++a){this.$3j[a].$F();this.$3j[a]=null}Array.clear(this.$3j);this.$3j=[]},$KZ:function(a){a>=this.$6D&&WordViewer.Search.$X.get_$0().$Kr()},$kk:function(a){return this.$3j[a]},$F:function(){this.$7i();this.$3j=null}};WordViewer.Search.$4P=function(a){this.dispose=this.$F;this.$V=a;this.$75=[]};WordViewer.Search.$4P.prototype={$75:null,$V:0,$F:function(){for(var b,a=0;a<this.$75.length;++a){b=this.$75[a];if(b){WordViewer.Highlight.$h.get_$0().$Km(this.$75[a]);b=null}}},$ej:function(a){this.$75[this.$75.length]=a}};WordViewer.Search.$4Q=function(a){this.$$d_$aT=Function.createDelegate(this,this.$aT);this.$$d_$dP=Function.createDelegate(this,this.$dP);this.$$d_$s1=Function.createDelegate(this,this.$s1);this.$$d_$GN=Function.createDelegate(this,this.$GN);this.$$d_$vV=Function.createDelegate(this,this.$vV);this.$5A=Number.NaN;this.$5H=Number.NaN;this.$Dm=Number.NaN;this.$NS=Number.NaN;this.dispose=this.$F;this.$16=a;Common.$0.$5.$1G(851844167,1,this.$$d_$vV,8);WordViewer.App.get_$1().$z.$4(0,this.$$d_$GN,null);this.$35={};this.$Hz=new Common.$p(3,1,10,this.$$d_$s1)};WordViewer.Search.$4Q.prototype={$16:null,$35:null,$36:null,$Hz:null,$2O:0,$7y:0,$6L:false,$B7:0,$B6:0,$4a:null,$Br:0,$M7:null,$B8:true,$F:function(){this.$7i();this.$35=null;this.$4a=null;this.$16=null;this.$Hz=null},$GN:function(){this.$bO()},$vV:function(){this.$bO();return 32},$7i:function(){if(this.$6L){Common.$0.$E.$2x(this.$Hz);this.$6L=false}this.$WM();this.$4a=null;this.$5A=Number.NaN;this.$5H=Number.NaN;this.$B8=true;this.$Dm=Number.NaN;this.$M7=null},$um:function(){if(this.$36){Common.$0.$E.$2x(this.$36);this.$36=null}},$u2:function(){var a=WordViewer.App.get_$1().$B;this.$5A=a.$Pr();this.$5H=a.$Ji();this.$Vz()},$Vz:function(){this.$WM();this.$2O=WordViewer.App.get_$1().$B.$4A();this.$7y=0;this.$36=new Common.$p(3,1,WordViewer.App.$0.$I.$Jv,this.$$d_$dP);this.$dP(null)},$WM:function(){this.$um();var a=this.$35;for(var b in a){var c={key:b,value:a[b]};this.$P7(c.key)}this.$35={}},$P7:function(c){if(this.$35[c]){for(var a=this.$35[c],d,b=0;b<a.length;++b){d=a[b];d.$F();a[b]=null}Array.clear(a);delete this.$35[c];if(c===this.$Dm){this.$B8=false;WordViewer.Search.$X.get_$0().$P6()}}},$dP:function(){var b=WordViewer.App.get_$1().$B,a;if(!WordViewer.Highlight.$h.get_$0().$Z4(this.$2O)){Common.$0.$E.$i(this.$36);return}a=WordViewer.App.get_$1().$1B.$7V(this.$2O);if(!a){Common.$0.$E.$i(this.$36);return}this.$4a=a.selectNodes("descendant::P");this.$Br=0;this.$36=new Common.$p(3,1,WordViewer.App.$0.$I.$Jv,this.$$d_$aT);Common.$0.$E.$i(this.$36)},$aT:function(){this.$B6=0;this.$B7=0;var b=WordViewer.App.$0.$I,a=this.$35[this.$2O];if(!a){a=[];this.$35[this.$2O]=a}while(this.$Br<this.$4a.length&&this.$B6<b.$ZX&&this.$B7<b.$ZW)this.$aS();if(this.$Br<this.$4a.length)Common.$0.$E.$i(this.$36);else this.$Yl()},$Yl:function(){var c=this.$5H-this.$5A+1,a=0,b=WordViewer.App.get_$1().$B.$4A();if(b!==this.$NS){this.$2O=b;this.$NS=b}while(a!==c&&this.$35[this.$2O]){a++;this.$2O=this.$2O===this.$5H?this.$5A:this.$2O+1}if(a===c)this.$36=null;else{this.$7y=0;this.$36=new Common.$p(3,1,WordViewer.App.$0.$I.$Jv,this.$$d_$dP);Common.$0.$E.$i(this.$36)}},$aS:function(){var b=this.$4a[this.$Br];if(!b.selectSingleNode("ancestor::P")){var a=b.selectNodes("descendant::T/text()"),c=WordViewer.Search.$o.$YL(a);a.length&&this.$YU(c,a);this.$B7++;this.$B6+=c.length}this.$Br++},$YU:function(w,i){var g,d,j,k=new RegExp(WordViewer.Search.$o.$8O,"ig"),e=0,a=0,o=WordViewer.App.get_$1().$B,p=WordViewer.Search.$X.get_$0(),q=o.$1W(),b=this.$35[this.$2O];if(!b){b=[];this.$35[this.$2O]=b}while(j=k.exec(w)){var l=!this.$B8&&this.$2O===this.$Dm;g=j.index;d=k.lastIndex;for(var c=0,r=0,m=new WordViewer.Search.$4P(this.$2O),n,f=null;e<i.length;++e){var s=i[e];c=a+s.data.length;if(a<d&&c>g){var t=i[e].parentNode,u=Math.max(0,g-a),v=Math.min(c-a,d-a);n=WordViewer.Highlight.$h.get_$0().$h0(t,u,v);if(!f){f=String.format("{0}-{1}",this.$2O,this.$7y);this.$7y++;if(l&&f===this.$M7)this.$B8=true}r++;var h=WordViewer.Highlight.$h.get_$0().$PU(n,1,f,this.$2O);WordViewer.Search.$o.$al(h,this.$2O,q);m.$ej(h);this.$B8&&l&&p.$Pk(h)}if(c>=d)break;a=c}b[b.length]=m}},$ZO:function(a,b,c){this.$Dm=a;this.$M7=b;this.$B8=c},$KZ:function(a,b){if(WordViewer.Search.$o.$8O===""||this.$5A===a&&this.$5H===b)return;if(this.$36&&(this.$2O<a||this.$2O>b)){Common.$0.$E.$2x(this.$36);this.$36=null}if(isNaN(this.$5A)||isNaN(this.$5H)||a>this.$5H||b<this.$5A){this.$5A=a;this.$5H=b;this.$Vz();return}else{for(var c=this.$5A;c<a;++c)this.$P7(c);for(var d=b+1;d<=this.$5H;++d)this.$P7(d)}this.$5A=a;this.$5H=b;if(!this.$36){this.$Br=Number.NaN;this.$Yl()}},$bO:function(){if(!this.$6L){this.$6L=true;Common.$0.$E.$i(this.$Hz)}},$s1:function(){for(var a=WordViewer.App.get_$1().$B,b=a.$1W(),h=a.$4A(),i=a.$Pr(),j=a.$Ji(),c,d=h;d<=j;++d)this.$RN(this.$35[d],b);for(var e=i;e<h;++e)this.$RN(this.$35[e],b);var f=this.$35;for(var g in f){var k={key:g,value:f[g]};c=k.key;(c<i||c>j)&&this.$RN(k.value,b)}this.$6L=false},$RN:function(e,g){if(e)for(var a,b,f,c=0;c<e.length;++c){a=e[c];b=a.$75;f=a.$V;for(var d=0;d<b.length;++d)WordViewer.Search.$o.$al(b[d],f,g)}},$Ps:function(b){return this.$35[b]}};Type.registerNamespace("WordViewer.Selection");WordViewer.Selection.$5A=function(a,b){this.$Wp=a;this.$Wz=b};WordViewer.Selection.$40=function(b){this.$$d_$PG=Function.createDelegate(this,this.$PG);this.$$d_$fv=Function.createDelegate(this,this.$fv);this.$$d_$oN=Function.createDelegate(this,this.$oN);this.$$d_$if=Function.createDelegate(this,this.$if);this.dispose=this.$F;this.$1D=document.createElement("iFrame");this.$1D.id="WACCopyFrame";this.$1D.className="WACCopyFrame";var a=Common.$E.$0();a.$o("document").$Vi(this.$$d_$if);Common.$A.$h(this.$1D,"load",this.$$d_$oN);b.appendChild(this.$1D);Common.$0.$5.$C(1041156544,1,WordViewer.App.$0.get_$7S()?this.$$d_$fv:Common.$U.$AE)};WordViewer.Selection.$40.prototype={$1D:null,$K:null,$Q:null,$if:function(){this.$Am()},$lh:function(){this.$1D.contentWindow.document.body.id="WACCopyFrameBody";WordViewer.App.get_$1().$31.$8m(this.$1D.contentWindow.document.body);WordViewer.App.get_$1().$4x.$4(this.$1D.contentWindow.document.body,this.$$d_$PG);WordViewer.App.get_$1().$31.$4("keypress",this.$1D.contentWindow.document.body,WordViewer.App.get_$1().$$d_$uc,null);WordViewer.App.get_$1().$8v.$4("compositionstart",this.$1D.contentWindow.document.body,WordViewer.App.get_$1().$$d_$uc,null)},$fv:function(){var a=WordViewer.Selection.$16.$kH(this.$K,this.$Q);this.$qY(a);return 32},$PG:function(a){WordViewer.Controls.$a.$uN(a);return true},$oN:function(){this.$1D.contentWindow.document.title=WordViewerIntl.WordViewerStrings.l_CopyIframeTitle;this.$lh()},$gd:function(){var a=false,b=Number.MAX_VALUE,c=Number.MIN_VALUE;if(this.$K&&this.$Q){a=true;b=this.$K.$V;c=this.$Q.$V}this.$ge();this.$K=null;this.$Q=null;a&&WordViewer.App.get_$1().$1B.$4H(b,c)},$dD:function(a,b){if(!WordViewer.App.$0.get_$7S())return;if(!a||!b)return;if(a.$8>b.$8){var f=a;a=b;b=f}this.$K=a;this.$Q=b;for(var e=WordViewer.App.get_$1().$1B,d=true,c=this.$K.$V;c<=this.$Q.$V;c++)if(!e.$AM(c)){d=false;break}if(d)Common.$0.$5.$N(1041156544,2);else WordViewer.App.get_$1().$1B.$CK(this.$K.$V,this.$Q.$V)},$ge:function(){this.$Xd();var a=this.$1D.contentWindow.document.body;Common.$5.$F2(a);Common.$E.$0().$2H("document")},$qY:function(a){!a.length;if(!WordViewer.App.$0.get_$7S())return;this.$Xd();var b=this.$1D.contentWindow.document.body;if(!b)return;Common.$5.$F2(b);for(var c=0;c<a.length;c++)b.appendChild(a[c]);Common.$E.$0().$2H("document");a.length>0&&this.$Am()},$Am:function(){this.$1D.contentWindow.focus();if(Common.$2.get_$4D()){var a=this.$1D.contentWindow.getSelection();a.removeAllRanges();a.selectAllChildren(this.$1D.contentWindow.document.body)}else this.$1D.contentWindow.document.execCommand("SelectAll")},$Xd:function(){if(Common.$2.get_$4D()){var a=this.$1D.contentWindow;if(window.self.__loadCompat&&!a.attachEvent){__loadCompat(a);_loadMozillaCompat(a)}}},$F:function(){Common.$A.$a(this.$1D,"load",this.$$d_$oN);if(this.$K){this.$K.$F();this.$K=null}if(this.$Q){this.$Q.$F();this.$Q=null}if(this.$1D.contentWindow&&this.$1D.contentWindow.document&&this.$1D.contentWindow.document.body){WordViewer.App.get_$1().$31.$A("keypress",this.$1D.contentWindow.document.body,WordViewer.App.get_$1().$$d_$uc);WordViewer.App.get_$1().$8v.$A("compositionstart",this.$1D.contentWindow.document.body,WordViewer.App.get_$1().$$d_$uc);WordViewer.App.get_$1().$31.$49(this.$1D.contentWindow.document.body);WordViewer.App.get_$1().$4x.$A(this.$1D.contentWindow.document.body,this.$$d_$PG)}this.$1D=null}};WordViewer.Selection.$2G=function(c,d){this.dispose=this.$F;this.$8P=c;this.$8X=d;if(this.$8X){this.$8=parseInt(this.$8X.attributes.getNamedItem("id").nodeValue);var a=this.$8X.parentNode;this.$9s=parseInt(a.attributes.getNamedItem("storyId").nodeValue);var b=a.selectSingleNode("ancestor::Page");this.$V=parseInt(b.attributes.getNamedItem("id").nodeValue)}};WordViewer.Selection.$2G.prototype={$8P:null,$8:0,$9s:0,$V:0,$8X:null,$F:function(){this.$8P=null}};WordViewer.Selection.$W=function(d){this.$$d_$WU=Function.createDelegate(this,this.$WU);this.$$d_$h1=Function.createDelegate(this,this.$h1);this.$$d_$uI=Function.createDelegate(this,this.$uI);this.$$d_$h6=Function.createDelegate(this,this.$h6);this.$$d_$fq=Function.createDelegate(this,this.$fq);this.$$d_$tI=Function.createDelegate(this,this.$tI);this.$$d_$vZ=Function.createDelegate(this,this.$vZ);this.$$d_$vn=Function.createDelegate(this,this.$vn);this.$$d_$sS=Function.createDelegate(this,this.$sS);this.$$d_$oK=Function.createDelegate(this,this.$oK);this.$$d_$gj=Function.createDelegate(this,this.$gj);this.$$d_$s2=Function.createDelegate(this,this.$s2);this.$$d_$pK=Function.createDelegate(this,this.$pK);this.$$d_$a5=Function.createDelegate(this,this.$a5);this.$$d_$Zz=Function.createDelegate(this,this.$Zz);this.$$d_$Qy=Function.createDelegate(this,this.$Qy);this.$$d_$AS=Function.createDelegate(this,this.$AS);this.$$d_$AJ=Function.createDelegate(this,this.$AJ);this.$8K=new Sys.UI.Point(0,0);this.$BS=new Sys.UI.Point(0,0);this.$1i={};this.dispose=this.$F;this.$16=d;this.$8K=WordViewer.Selection.$1d.$WC(this.$16);this.$1K=document.createElement("div");this.$1K.id="WACSurface";this.$1K.className="WACSurface";this.$bZ();this.$16.appendChild(this.$1K);this.$9q=new WordViewer.Selection.$57(this.$1K);if(WordViewer.App.$0.get_$7S())this.$3l=new WordViewer.Selection.$40(this.$1K);this.$3K=document.createElement("a");this.$61=document.createElement("div");this.$61.className="WACLink";this.$3K.appendChild(this.$61);this.$3K.target="_blank";this.$1K.appendChild(this.$3K);WordViewer.App.get_$1().$8w.$bA(this.$1K,this);WordViewer.App.get_$1().$1H.$4("click",this.$1K,this.$$d_$Qy,null);WordViewer.App.get_$1().$1H.$4("dblclick",this.$1K,this.$$d_$Zz,null);var b=WordViewer.App.get_$1().$3Y;b.$4("mousedown",this.$1K,this.$$d_$a5,null);b.$4("mousemove",this.$1K,this.$$d_$pK,null);this.$Ni=new Common.$p(3,1,10,this.$$d_$s2);this.$T4=new Common.$p(3,1,1e3,this.$$d_$gj);Common.$0.$5.$1G(2092285007,1,this.$$d_$oK,8);Common.$0.$5.$1G(3219498311,1,this.$$d_$sS,8);var a=Common.$0.$5;a.$1G(779228655,1,this.$$d_$vn,9);a.$1G(2195537549,1,this.$$d_$vZ,8);a.$1G(1297807363,1,this.$$d_$tI,9);a.$C(2474762090,1,this.$$d_$fq);a.$C(3383614517,1,this.$$d_$h6);a.$C(2802067523,1,this.$$d_$uI);a.$C(3458683028,1,this.$$d_$h1);var c=Common.$E.$0().$o("document");c.$c(Common.$G.$f(67,2),2474762090)};WordViewer.Selection.$W.get_$0=function(){if(!WordViewer.Selection.$W.$D&&!WordViewer.Selection.$W.$2q){WordViewer.Selection.$W.$2q=true;WordViewer.Selection.$W.$D=new WordViewer.Selection.$W(WordViewer.App.get_$1().$B.$1h.$3A);WordViewer.Selection.$W.$2q=false}return WordViewer.Selection.$W.$D};WordViewer.Selection.$W.$bv=function(a){a.contentWindow.focus();if(Common.$2.get_$4D()||Common.$2.get_$QH()){var b=a.contentWindow.getSelection();if(b){b.removeAllRanges();b.selectAllChildren(a.contentWindow.document.body)}}else a.contentWindow.document.execCommand("SelectAll",false,null)};WordViewer.Selection.$W.$XO=function(a){if(Common.$2.get_$1s()){var b=a.selection.createRange();b.execCommand("paste")}else a.execCommand("paste",false,null)};WordViewer.Selection.$W.$jM=function(a){if(Common.$2.get_$1s()){var b=a.selection.createRange();b.execCommand("copy")}else a.execCommand("copy",false,null)};WordViewer.Selection.$W.$ZV=function(a){var c=["javascript:","vbscript:"];if(!a)return null;for(var d=Common.$9.$2i(a),e=c.length,b=0;b<e;++b)if(Common.$9.$cj(d,c[b]))return null;return Common.$9.$mA(a)?a:"BLOCKED:"+a};WordViewer.Selection.$W.$ZD=function(a){return!a?false:a.childNodes.length===1&&a.childNodes[0].nodeType===3&&WordViewer.Selection.$16.$Qt(a)?true:false};WordViewer.Selection.$W.$ZE=function(b){if(!b)return false;var a=b.selectSingleNode("LT");return a?!a.attributes.getNamedItem("p")||!a.attributes.getNamedItem("l")||!a.attributes.getNamedItem("t")?false:true:false};WordViewer.Selection.$W.prototype={$Dg:false,$3K:null,$61:null,$16:null,$1K:null,$K:null,$Q:null,$7G:null,$7F:null,$3l:null,$9q:null,$VB:0,$Ni:null,$6L:false,$T4:null,$AJ:function(){return!this.$K||!this.$Q?Number.MAX_VALUE:Math.min(this.$K.$V,this.$Q.$V)},$AS:function(){return!this.$K||!this.$Q?Number.MIN_VALUE:Math.max(this.$K.$V,this.$Q.$V)},get_$bx:function(){return!this.$K?null:!this.$Q?this.$K:this.$K.$8>this.$Q.$8?this.$Q:this.$K},get_$bw:function(){return!this.$Q?null:!this.$K?this.$Q:this.$K.$8>this.$Q.$8?this.$K:this.$Q},get_$qs:function(){return!this.$7G?null:!this.$7F?this.$K:this.$7G.$8>this.$7F.$8?this.$7F:this.$7G},get_$qr:function(){return!this.$7F?null:!this.$7G?this.$Q:this.$7G.$8>this.$7F.$8?this.$7G:this.$7F},$F:function(){var c,a=this.$1i;for(var b in a){var e={key:b,value:a[b]};c=e.value;c.$F()}this.$3K&&this.$3K.parentNode&&this.$3K.parentNode.removeChild(this.$3K);this.$3K=null;this.$61=null;if(this.$3l){this.$3l.$F();this.$3l=null}if(this.$9q){this.$9q.$F();this.$9q=null}if(this.$6L){Common.$0.$E.$2x(this.$Ni);this.$6L=false}WordViewer.App.get_$1().$8w.$SN(this.$1K,this);WordViewer.App.get_$1().$1H.$A("click",this.$1K,this.$$d_$Qy);WordViewer.App.get_$1().$1H.$A("dblclick",this.$1K,this.$$d_$Zz);var d=WordViewer.App.get_$1().$3Y;d.$A("mousedown",this.$1K,this.$$d_$a5);d.$A("mousemove",this.$1K,this.$$d_$pK);this.$1i=null;this.$16=null;this.$1K=null},$vn:function(h,i,j,k,g){var a=g,b=a.$AJ,e=a.$AS,f=WordViewer.App.get_$1().$1B,c;if(!this.$K||!this.$Q)return 32;for(var d=b;d<=e;d++){c=f.$AM(b);this.$by(c,this.$K,this.$Q)}return 32},$vZ:function(){this.$bP();return 32},$tI:function(r,s,t,u,q){if(!this.$K)return 32;if(!this.$Q)this.$Q=this.$K;var g=q,h=g.$Wz,o=g.$Wp,d=WordViewer.App.get_$1().$B.$1W(),i=WordViewer.App.get_$1().$B.$5a()+o,a=WordViewer.DocumentData.$8.$Cl(i,d),e=new Sys.UI.Point(0,0);if(Common.$0.get_$d())e.x=WordViewer.DocumentData.$8.$FS(a,d)-this.$BS.x;else e.x=this.$BS.x-WordViewer.DocumentData.$8.$6U(a,d,false);e.y=i-WordViewer.DocumentData.$8.$2y(a,d);var p=WordViewer.Selection.$16.$gE(a,this.$K.$9s,h,e),j=WordViewer.App.get_$1().$1B.$AM(a);if(!j)return 32;for(var f=j.selectNodes(p),k=null,l=null,m=Number.MIN_VALUE,n=Number.MAX_VALUE,b,c=0;c<f.length;c++){b=parseInt(f[c].attributes.getNamedItem("id").nodeValue);if(b<n){n=b;l=f[c]}if(b>m){m=b;k=f[c]}}this.$LU(h?l:k);return 32},$fq:function(){Common.$0.$G.$4o(8812,1);return 4},$h1:function(){if(!this.$K||!this.$Q)return 32;var b=0,c=0;if(!isNullOrUndefined(this.$K)&&!isNullOrUndefined(this.$K.$8X)){var a=this.$K.$8X.attributes,k=Math.round(parseFloat(a.getNamedItem("l").nodeValue)),l=Math.round(parseFloat(a.getNamedItem("t").nodeValue)),m=Math.round(parseFloat(a.getNamedItem("w").nodeValue)),n=Math.round(parseFloat(a.getNamedItem("h").nodeValue));b=k+m/2;c=l+n/2}var f=WordViewer.App.get_$1().$B.$1h.$3A.offsetLeft,d=WordViewer.App.get_$1().$B,g=d.$5a(),e=d.$1W(),h=this.$K.$V,i=Math.round(WordViewer.DocumentData.$8.$2y(h,e)/e),j=new Sys.UI.Point(b+f,i-g+c);WordViewer.Controls.$a.$7x.$LC("mnuSelectionViewer",j,2);return 32},$h6:function(e,f,c){if(!this.$K||!this.$Q)return 8;if(c===1)return WordViewer.App.$6Y()?32:8;var a;try{this.$3l.$dD(this.get_$bx(),this.get_$bw());WordViewer.Selection.$W.$jM(this.$3l.$1D.contentWindow.document);a=true}catch(d){this.$YW();a=false}if(!a)return 8;var b=Common.$2.get_$6Z()&&!Common.$2.get_$mL()&&!Common.$2.get_$QA();if(b||this.$v3()){this.$3l.$Am();return 32}return 8},$uI:function(c,d,e,f,b){var a=b;if(this.$8i(a,7)){(!this.$K||!this.$Q)&&this.$8i(a,3);WordViewer.Controls.$a.$7x.$LC("mnuSelectionViewer",a.get_clientPoint(),a.$1E);return 32}return 8},$v3:function(){if(WordViewer.Selection.$W.$IL)return true;if(isNullOrUndefined(this.$3l))return false;var b=this.$3l.$1D,a=b.contentWindow.document,d=new Common.$4C(a.body),c=false;try{Common.$5.$Iy(a.body);WordViewer.Selection.$W.$bv(b);WordViewer.Selection.$W.$XO(a);var e=a.body.innerText;a.body.innerText="TESTING CLIPBOARD ACCESS";WordViewer.Selection.$W.$bv(b);WordViewer.Selection.$W.$XO(a);c=e===a.body.innerText}catch(f){}d.$sW();if(!c){this.$YW();return false}WordViewer.Selection.$W.$IL=true;return true},$YW:function(){WordViewer.Selection.$W.$IL=false;var a=new CommonUI.$t;a.set_$W(0);a.$cc(CommonUIIntl.CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIIntl.CommonUIStrings.l_ClipboardAccessDenied,this.$$d_$WU)},$WU:function(){this.$3l.$Am();return},$8i:function(d,i){var m=d.$P.rawEvent.shiftKey,h=WordViewer.App.get_$1().$B,j=h.$Cm(),k=h.$5a(),e=new Sys.UI.Point(0,0);if(Common.$0.get_$d())e.x=h.$5b()+this.$1K.offsetLeft+Math.abs(j)-d.get_clientPoint().x;else e.x=d.get_clientPoint().x+j-this.$8K.x;e.y=d.get_clientPoint().y+k-this.$8K.y;var b=WordViewer.App.get_$1().$B.$1W(),c=WordViewer.DocumentData.$8.$Cl(e.y,b);this.$BS=new Sys.UI.Point(e.x-j,e.y-k);this.$Dg&&this.$9q.$vQ(this.$BS);var a=new Sys.UI.Point(0,0);if(Common.$0.get_$d()){var n=WordViewer.DocumentData.$8.$FS(c,b);a.x=Math.round((n-e.x)/b)}else{var o=WordViewer.DocumentData.$8.$6U(c,b,false);a.x=Math.round((e.x-o)/b)}a.y=Math.round((e.y-WordViewer.DocumentData.$8.$2y(c,b))/b);var l=WordViewer.App.get_$1().$1B,f=null,g=null;if(l){f=WordViewer.Selection.$16.$l1(a,c,l.$AM(c));g=WordViewer.Selection.$16.$l0(a,c,l.$AM(c))}if(i===4){if(WordViewer.Selection.$W.$ZE(g))this.$1K.style.cursor="pointer";else if(WordViewer.Selection.$W.$ZD(g))this.$u0(g,k,c,b);else{this.$v0();this.$1K.style.cursor=WordViewer.Selection.$16.$Qt(f)?"text":""}return false}if(i===3&&d.$1E===3&&WordViewer.Selection.$W.$ZD(g)){window.open(WordViewer.Selection.$W.$ZV(g.text));return true}if(i===3&&WordViewer.Selection.$W.$ZE(g)){this.$nP(g);return true}switch(i){case 0:this.$9q.$tw(this.$BS);this.$Or(f,m);break;case 1:this.$ZZ(f);break;case 2:this.$JP();break;case 3:if(d.$1E===3){var p=this.$WL(a.x,a.y);if(p)WordViewer.App.get_$1().$Ef.$LA(d);else this.$bz(f)}else if(f){this.$Or(f,m);this.$ZZ(f);this.$JP()}else d.$5Y!=="contextmenu"&&this.$4k();break;case 5:this.$bz(f);break;case 6:return this.$WL(a.x,a.y);case 7:var q=Common.$0.get_$d()?WordViewer.App.get_$1().$4W?WordViewer.App.$0.$I.$PC:0:WordViewer.App.get_$1().$5F?WordViewer.App.$0.$I.$Rm:0;return a.x<0||a.x>WordViewer.DocumentData.$8.$4n(c,b)/b||d.get_clientPoint().x-q>h.$5b()?false:a.y<0||a.y>WordViewer.DocumentData.$8.$6T(c,b)/b||d.get_clientPoint().y-h.$1w.offsetTop>h.$AK()?false:true}return true},$WL:function(e,f){if(!this.$K||!this.$Q)return false;var d=null,b=this.$1i;for(var c in b){var g={key:c,value:b[c]};d=g.value;var a=d.$8P;if(e>=a.get_$ZK()&&e<=a.get_$ZK()+a.get_$Sd()&&f>=a.get_$cw()&&f<=a.get_$cw()+a.get_$lG())return true}return false},$u0:function(b,f,d,a){var c=WordViewer.Selection.$W.$ZV(b.text);if(c){this.$3K.href=c;var g=Math.round(parseFloat(b.attributes.getNamedItem("t").nodeValue)),e=Math.round(parseFloat(b.attributes.getNamedItem("l").nodeValue)),h=f-WordViewer.DocumentData.$8.$2y(d,a);this.$61.style.top=f+g*a-h+"px";if(Common.$0.get_$d()){var i=Math.round(parseFloat(b.attributes.getNamedItem("w").nodeValue));this.$61.style.right=WordViewer.DocumentData.$8.$FS(d,a)-(i+e)*a+"px"}else this.$61.style.left=WordViewer.DocumentData.$8.$6U(d,a,false)+e*a+"px";this.$61.style.width=Math.round(parseFloat(b.attributes.getNamedItem("w").nodeValue)*a)+"px";this.$61.style.height=Math.round(parseFloat(b.attributes.getNamedItem("h").nodeValue)*a)+"px";this.$61.title=c;this.$1K.parentNode.parentNode.appendChild(this.$3K);return true}return false},$v0:function(){this.$3K&&this.$3K.parentNode&&this.$3K.parentNode.removeChild(this.$3K)},$nP:function(d){if(!d.hasChildNodes())return;var a=d.selectSingleNode("LT"),e=a.attributes.getNamedItem("p"),f=a.attributes.getNamedItem("t"),g=parseInt(e.nodeValue),h=parseInt(f.nodeValue),b=WordViewer.App.get_$1().$B.$1W(),c=WordViewer.DocumentData.$8.$2y(g,b);c+=h*b;var i=parseInt(this.$1K.style.height);Common.$0.$5.$t(702693766,2,new WordViewer.Controls.$1c(c-i*.2,0))},$Or:function(a,c){this.$Dg=true;var b=null;if(a)b=new WordViewer.Selection.$2G(null,a);if(!c||!this.$Q||!this.$K){this.$4k();this.$3l&&this.$3l.$gd();this.$K=b}else this.$LU(a)},$ZZ:function(a){this.$LU(a)},$JP:function(){this.$9q.$sL();this.$Dg&&this.$3l&&this.$3l.$dD(this.$K,this.$Q);this.$1K.style.cursor="";this.$Dg=false},$4k:function(){var c,a=this.$1i;for(var b in a){var d={key:b,value:a[b]};c=d.value.$8P;WordViewer.Highlight.$h.get_$0().$Km(c)}this.$7G=this.$K;this.$7F=this.$Q;Common.$0.$E.$i(this.$T4);this.$1i={};this.$K=null;this.$Q=null},$gj:function(){this.$7G||this.$7F;this.$7G=null;this.$7F=null},$DR:function(a,b){if(b<a){var i;i=a;a=b;b=i}var c=[],d,e,g=this.$1i;for(var h in g){var j={key:h,value:g[h]};d=j.value.$8P;e=parseInt(d.get_$Yo());if(e>=a&&e<=b){WordViewer.Highlight.$h.get_$0().$Km(d);Array.add(c,j.key)}for(var f=0;f<c.length;f++)delete this.$1i[c[f]]}},$LU:function(d){if(!this.$Q){this.$G4(this.$K,this.$K);this.$Q=this.$K}if(!d)return;var a=new WordViewer.Selection.$2G(null,d);if(a.$9s!==this.$K.$9s||a.$9s!==1&&a.$V!==this.$K.$V)return;var b=this.$Q.$V,c=WordViewer.App.get_$1().$1B;if(this.$K.$8<a.$8){if(this.$Q.$8<this.$K.$8){this.$DR(this.$Q.$8,this.$K.$8-1);this.$G4(this.$K,a);this.$Q=a;c.$4H(b,this.$K.$V)}else if(this.$Q.$8<a.$8){this.$G4(this.$Q,a);this.$Q=a}else if(a.$8<this.$Q.$8){this.$DR(a.$8+1,this.$Q.$8);this.$Q=a;c.$4H(a.$V,b)}}else if(a.$8<this.$K.$8){if(this.$K.$8<this.$Q.$8){this.$DR(this.$K.$8+1,this.$Q.$8);this.$G4(a,this.$K);this.$Q=a;c.$4H(this.$K.$V,b)}else if(a.$8<this.$Q.$8){this.$G4(a,this.$Q);this.$Q=a}else if(this.$Q.$8<a.$8){this.$DR(this.$Q.$8,a.$8-1);this.$Q=a;c.$4H(b,a.$V)}}else if(a.$8===this.$K.$8&&this.$Q.$8!==this.$K.$8)if(this.$Q.$8<this.$K.$8){this.$DR(this.$Q.$8,this.$K.$8-1);this.$Q=a;c.$4H(b,a.$V)}else{this.$DR(this.$K.$8+1,this.$Q.$8);this.$Q=a;c.$4H(a.$V,b)}},$G4:function(a,b){if(b.$8<a.$8){var e;e=a;a=b;b=e}for(var f=WordViewer.App.get_$1().$1B,d,c=a.$V;c<=b.$V;c++){d=f.$AM(c);this.$by(d,a,b)}},$bz:function(c){if(!c){this.$4k();return}var b=c.selectSingleNode("ancestor::P");if(!b)return;var a=b.selectNodes("descendant::T");if(!a||!a.length)return;this.$Or(a[0],false);this.$LU(a[a.length-1]);this.$JP()},$by:function(g,n,o){if(!g)return;var h=WordViewer.Selection.$16.$gC(n,o),b=g.selectNodes(h);if(!b.length)return;for(var a,d,f,i=b[0].selectSingleNode("ancestor::Page"),j=parseInt(i.selectSingleNode("@id").text),e=0;e<b.length;e++){a=b[e];d=a.attributes.getNamedItem("id").nodeValue;if(this.$1i[d])continue;if(WordViewer.Selection.$16.$Qt(a)){var k=WordViewer.App.get_$1().$B.$1W(),l=WordViewer.Selection.$16.$YH(a),m=WordViewer.Highlight.$h.get_$0(),c=m.$PU(l,0,d,WordViewer.$6.$YF(a));c.$L8(c.get_$Ey(),j,k);f=new WordViewer.Selection.$2G(c,a);this.$1i[c.get_$Yo()]=f}}},$bP:function(){if(!this.$6L){this.$6L=true;Common.$0.$E.$i(this.$Ni)}},$s2:function(){var d=WordViewer.App.get_$1().$B.$1W(),a,b=this.$1i;for(var c in b){var e={key:c,value:b[c]};a=e.value;var f=WordViewer.Selection.$16.$YH(a.$8X);a.$8P.$L8(f,WordViewer.$6.$YF(a.$8X),d)}this.$uW();this.$6L=false},$sS:function(){this.$bZ();return 32},$bZ:function(){var a=Common.$0.get_$d();this.$8K=WordViewer.Selection.$1d.$WC(this.$16.parentNode);if(a)if(Common.$2.get_$1s()&&!Common.$2.get_$7a()||Common.$2.get_$QA())this.$8K.x+=WordViewer.App.get_$1().$B.$Jq();this.$1K.style.left=this.$8K.x+"px";this.$1K.style.top=this.$8K.y+"px";this.$VB=WordViewer.App.get_$1().$B.$Jg();this.$1K.style.height=this.$VB+"px";this.$1K.style.width=WordViewer.App.get_$1().$B.$5b()+"px"},$oK:function(){this.$bP();return 32},$Ju:function(){var a=this.$1i;for(var b in a){var c={key:b,value:a[b]},d=c.value.$8P;d.$lL()}},$uW:function(){var a=this.$1i;for(var b in a){var c={key:b,value:a[b]},d=c.value.$8P;d.$uO()}},$QC:function(a){return a.$1E===2?!a.$2J:false},$oY:function(a){if(!this.$QC(a))return false;var b=this.$8i(a,0);return b},$a0:function(b){if(!this.$K)return false;var a=this.$8i(b,1);return a},$oW:function(a){if(a.$2J)return;this.$8i(a,2)},$KV:function(){this.$JP()},$Qy:function(b){return this.$8i(b,3)},$Zz:function(b){return this.$8i(b,5)},$a5:function(){Common.$E.$6i()&&Common.$E.$0().$2H("document");document.body.focus();return false},$pK:function(a){!this.$Dg&&this.$8i(a,4);return false}};WordViewer.Selection.$57=function(a){this.$$d_$jo=Function.createDelegate(this,this.$jo);this.$K=new Sys.UI.Point(-1,-1);this.$9g=new Sys.UI.Point(-1,-1);this.$7J=new Sys.UI.Point(-1,-1);this.$GT=+new Date(0);this.dispose=this.$F;this.$By=a;this.$E7=this.$GT};WordViewer.Selection.$57.prototype={$By:null,$Eb:0,$Dl:false,$Nr:0,$E7:0,$tw:function(b){if(this.$K.y!==-1)return;this.$K=b;var a=WordViewer.App.get_$1().$B.$AK();if(this.$K.y<=WordViewer.App.$0.$I.$Kw)this.$Eb=0;else if(a-this.$K.y<WordViewer.App.$0.$I.$Kw)this.$Eb=2;else this.$Eb=1},$vQ:function(a){var b=WordViewer.App.$0.$I.$Kw,c=Math.round(b*WordViewer.App.$0.$I.$t6/100);this.$7J=new Sys.UI.Point(a.x,a.y);if(!this.$Eb)if(a.y+c<this.$K.y)this.$7J.y=b+c+a.y-this.$K.y;else this.$LL();else if(this.$Eb===2)if(this.$K.y<a.y-c)this.$7J.y=this.$By.clientHeight+a.y-b-this.$K.y-c;else this.$LL();if(this.$7J.y<b||this.$By.offsetHeight-this.$7J.y<b){this.$9g=a;if(!this.$Dl){if(this.$K.y===-1)this.$K=a;this.$Dl=true;this.$Nr=window.setTimeout(this.$$d_$jo,WordViewer.App.$0.$I.$br)}}else this.$LL()},$LL:function(){if(!this.$Dl)return;this.$By.style.cursor="";this.$Dl=false;this.$E7=this.$GT;window.clearTimeout(this.$Nr)},$sL:function(){this.$LL();this.$7J=new Sys.UI.Point(-1,-1);this.$9g=new Sys.UI.Point(-1,-1);this.$K=new Sys.UI.Point(-1,-1)},$jo:function(){if(!this.$Dl||this.$9g.y===-1||this.$K.y===-1||this.$7J.y===-1)return;var b=false,a=this.$E7!==this.$GT,c=+new Date,e=c-this.$E7;this.$E7=c;if(a)if(this.$7J.y<WordViewer.App.$0.$I.$Kw)if(this.$K.y<this.$9g.y)a=false;else b=true;else if(this.$K.y>this.$9g.y)a=false;if(a){var d=Math.floor(e/1e3*WordViewer.App.$0.$I.$t5);if(b)d*=-1;Common.$0.$5.$t(2778760596,2,new WordViewer.Controls.$1c(Math.round(WordViewer.App.get_$1().$B.$5a()+d),Number.NaN));Common.$0.$5.$t(1297807363,2,new WordViewer.Selection.$5A(this.$9g.y,b));this.$By.style.cursor="text"}this.$Nr=window.setTimeout(this.$$d_$jo,WordViewer.App.$0.$I.$br)},$F:function(){this.$By=null}};WordViewer.Selection.$16=function(){};WordViewer.Selection.$16.$gC=function(a,b){if(b.$8<a.$8){var c;c=a;a=b;b=c}return String.format("descendant::P[@storyId='{0}']/T[@id>='{1}' and @id<='{2}']",a.$9s,a.$8,b.$8)};WordViewer.Selection.$16.$gE=function(c,d,e,b){var a=String.format("/Pages/Page[@id='{0}']/descendant::P[@storyId='{1}']/T[@l<='{2}' and (@l + @w)>='{2}'",c,d,b.x);if(e)a+=String.format(" and (@t + @h)>='{0}']",b.y);else a+=String.format(" and @t<='{0}']",b.y);return a};WordViewer.Selection.$16.$YH=function(a){var b=Math.round(parseFloat(a.attributes.getNamedItem("l").nodeValue)),c=Math.round(parseFloat(a.attributes.getNamedItem("t").nodeValue)),d=Math.round(parseFloat(a.attributes.getNamedItem("w").nodeValue)),e=Math.round(parseFloat(a.attributes.getNamedItem("h").nodeValue));return new WordViewer.$1v(b,c,d,e)};WordViewer.Selection.$16.$l1=function(b,e,c){if(!c)return null;var a=WordViewer.App.$0.$I.$tJ,d=String.format("/Pages/Page[@id='{0}']/descendant::P/T[@l<='{1}' and (@l + @w)>='{2}' and @t<='{3}' and (@t + @h)>='{4}']",e,b.x+a,b.x-a,b.y+a,b.y-a);return c.selectSingleNode(d)};WordViewer.Selection.$16.$l0=function(a,d,b){if(!b)return null;var c=String.format("/Pages/Page[@id='{0}']/descendant::L[@l<='{1}' and (@l + @w)>='{2}' and @t<='{3}' and (@t + @h)>='{4}']",d,a.x,a.x,a.y,a.y);return b.selectSingleNode(c)};WordViewer.Selection.$16.$Qt=function(a){return!!a&&!!parseInt(a.attributes.getNamedItem("w").nodeValue)&&!!parseInt(a.attributes.getNamedItem("h").nodeValue)};WordViewer.Selection.$16.$kH=function(f,g){for(var h=WordViewer.Selection.$16.$gB(f,g),b=[],c=-1,a=f.$V;a<=g.$V;a++){var d=WordViewer.$6.$3E(a);if(d!==c){var e=WordViewer.App.get_$1().$1B.$kG(h,a);e&&Array.addRange(b,e);c=d}}return b};WordViewer.Selection.$16.$gB=function(a,b){if(b.$8<a.$8){var c;c=a;a=b;b=c}return String.format("/Pages/Page[@id>='{0}' and @id<='{1}']/descendant::P[@storyId='{2}']/T[@id>='{3}' and @id<='{4}']",a.$V,b.$V,a.$9s,a.$8,b.$8)};WordViewer.$29.registerClass("WordViewer.$29",WordViewer.$5t);WordViewer.$2j.registerClass("WordViewer.$2j",WordViewer.$5t);WordViewer.$2N.registerClass("WordViewer.$2N",WordViewer.$5t);WordViewer.$2o.registerClass("WordViewer.$2o",WordViewer.$5t);WordViewer.$2m.registerClass("WordViewer.$2m",WordViewer.$5t);WordViewer.$2q.registerClass("WordViewer.$2q",WordViewer.$5t);WordViewer.$68.registerClass("WordViewer.$68",WordViewer.$5s);WordViewer.$67.registerClass("WordViewer.$67",WordViewer.$5s);WordViewer.$66.registerClass("WordViewer.$66",WordViewer.$5s);WordViewer.$3Z.registerClass("WordViewer.$3Z");WordViewer.Comments.$18.registerClass("WordViewer.Comments.$18",null,Sys.IDisposable);WordViewer.Comments.$i.registerClass("WordViewer.Comments.$i");WordViewer.Comments.$2R.registerClass("WordViewer.Comments.$2R",null,Sys.IDisposable);WordViewer.Comments.$x.registerClass("WordViewer.Comments.$x",null,Sys.IDisposable);WordViewer.Comments.$I.registerClass("WordViewer.Comments.$I",null,Sys.IDisposable);WordViewer.Comments.$z.registerClass("WordViewer.Comments.$z",null,Sys.IDisposable);WordViewer.Comments.$2C.registerClass("WordViewer.Comments.$2C",null,Sys.IDisposable);WordViewer.Comments.$41.registerClass("WordViewer.Comments.$41");WordViewer.Comments.$2n.registerClass("WordViewer.Comments.$2n",null,Sys.IDisposable);WordViewer.Highlight.$5r.registerClass("WordViewer.Highlight.$5r");WordViewer.Highlight.$h.registerClass("WordViewer.Highlight.$h");WordViewer.Highlight.$4O.registerClass("WordViewer.Highlight.$4O",WordViewer.Highlight.$5r);WordViewer.Highlight.$4N.registerClass("WordViewer.Highlight.$4N",null,WordViewer.Highlight.$5i);WordViewer.Search.$43.registerClass("WordViewer.Search.$43");WordViewer.Search.$49.registerClass("WordViewer.Search.$49",null,Sys.IDisposable);WordViewer.Search.$X.registerClass("WordViewer.Search.$X",null,Sys.IDisposable);WordViewer.Search.$T.registerClass("WordViewer.Search.$T",null,Sys.IDisposable);WordViewer.Search.$2z.registerClass("WordViewer.Search.$2z",null,Sys.IDisposable);WordViewer.Search.$o.registerClass("WordViewer.Search.$o");WordViewer.Search.$58.registerClass("WordViewer.Search.$58",null,Sys.IDisposable);WordViewer.Search.$4P.registerClass("WordViewer.Search.$4P",null,Sys.IDisposable);WordViewer.Search.$4Q.registerClass("WordViewer.Search.$4Q",null,Sys.IDisposable);WordViewer.Selection.$5A.registerClass("WordViewer.Selection.$5A");WordViewer.Selection.$40.registerClass("WordViewer.Selection.$40",null,Sys.IDisposable);WordViewer.Selection.$2G.registerClass("WordViewer.Selection.$2G",null,Sys.IDisposable);WordViewer.Selection.$W.registerClass("WordViewer.Selection.$W",null,Common.$5Y,Sys.IDisposable);WordViewer.Selection.$57.registerClass("WordViewer.Selection.$57",null,Sys.IDisposable);WordViewer.Selection.$16.registerClass("WordViewer.Selection.$16");WordViewer.Comments.$18.$YV=null;WordViewer.Comments.$18.$aN=-1;WordViewer.Comments.$18.$Qs=0;WordViewer.Comments.$i.$3o=-1;WordViewer.Comments.$I.$2q=false;WordViewer.Comments.$I.$D=null;WordViewer.Highlight.$h.$2q=false;WordViewer.Highlight.$h.$D=null;WordViewer.Search.$X.$D=null;WordViewer.Search.$X.$2q=false;WordViewer.Search.$o.$8O="";WordViewer.Selection.$W.$IL=false;WordViewer.Selection.$W.$2q=false;WordViewer.Selection.$W.$D=null;WordViewer.$3Z.$vr()